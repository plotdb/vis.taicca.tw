<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html;charset=UTF-8"><base href="/"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1"><!-- Global site tag (gtag.js) - Google Analytics--><script async src="https://www.googletagmanager.com/gtag/js?id=G-HXVX4JRNGZ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HXVX4JRNGZ');</script><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap/main/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldiconfont/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldslider/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldloader/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldbutton/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldpalettepicker/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/loading.css/main/lite.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/transition.css/main/transition.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/ldcolorpicker/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@plotdb/sheet/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@plotdb/chart/main/index.min.css"><link rel="stylesheet" type="text/css" href="css/panel.css"><link rel="stylesheet" type="text/css" href="css/index.css"><title>文化內容產業概況 / 文化內容策進院</title><style type="text/css">#root{width:1024px;height:100%;display:flex;margin:auto}#side-panels{display:flex;flex-direction:column;justify-content:center;align-items:end;position:relative;width:260px;height:100%}#main-panel{flex:1 0 auto;display:flex;align-items:center;margin-left:1.5em;max-width:90vh}#data-list{flex:1 0 100px}#data-list>div{height:100%}.main-panel-inner{padding:.5em 1.5m 1.5em 1.5em;display:flex;flex-direction:column;height:100%}.side-panel{opacity:0;transition:all .15s ease-in-out;position:absolute;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:flex-end;z-index:1}.side-panel.active{opacity:1;z-index:2}@media(min-width:961px) and (min-height:700px){.d-mdh-none{display:none !important}.d-mdh-block{display:block !important}}@media(max-width:1024px){#root{width:100%;height:fit-content;padding:1em;display:block}#side-panels{width:100%;height:100%}#main-panel{margin:0}#data-list{flex:1 0 100vh !important}#data-list>div{height:100vh !important}.side-panel{display:none;position:relative;margin-bottom:3em;align-items:stretch}.side-panel.active{display:flex}.main-panel-inner{padding:0;display:flex;flex-direction:column;height:100%}}.dataset-item:hover{background:rgba(0,0,0,0.5)}.dataset-item.active{background:#09f;color:#fff}</style></head><body><div class="w-100 h-100 ld ld-over-inverse running" ld="loader"><div class="ld" style="width:100%;height:100%;top:0;left:0;"><img style="left:0;right:0;margin:-2.5em auto 0;width:5em;height:5em;" src="/assets/img/loader.svg"><div style="width:max-content;left:0;right:0;margin:2.5em auto 0;text-align:center;"><div class="text-sm">程式載入中<br>請稍候 ...</div></div></div><div id="root"><div id="side-panels"><div class="side-panel" ld-scope="" ld="panel list-scope" data-name="list"><div class="w-100 d-flex flex-column" style="height:80%"><div class="d-flex justify-content-end" style="flex:0 0 auto"><h5>產調詳細數據</h5></div><div class="rounded p-3 text-right pnl" style="flex:0 0 auto"><div class="d-flex mb-2 align-items-center justify-content-end text-sm" style="line-height:1em"><div class="rounded-circle mr-2" style="height:.9em;width:.9em;" ld="picked-cat-color"></div><div><span ld="picked-cat"></span>產業</div></div><div class="mb-1" ld="picked-cat-color" style="width:100%;border-radius:2px;height:2px"></div><div class="text-hl" style="min-height:3em" ld="picked-name">...</div></div><div class="text-left pnl mt-3 px-0 pb-0" id="data-list"><div class="d-flex flex-column"><div class="px-3"><input class="form-control mb-3" style="border-color:rgba(255,255,255,.2);background:rgba(0,0,0,.5)" ld="dataset-search-field" placeholder="搜尋資料 ... "></div><div class="flex-grow-1" style="overflow-y:scroll"><div class="px-3 py-1 dataset-item" ld="no-data-item">沒有資料符合搜尋條件</div><div class="dataset-item py-1 px-3 clickable" ld-each="data-item"><div class="d-flex align-items-stretch"><div style="flex:0 0 auto;padding:.2em 0"><div class="mr-2 h-100" style="width:.25em;border-radius:.1em" ld="dataset-color"></div></div><div class="flex-grow-1" ld="dataset-name">...</div></div></div></div></div></div></div></div><div class="side-panel" ld-scope="" ld="panel" data-name="config"><div class="text-right mb-4"><div class="btn btn-sm btn-outline-secondary" ld="close-panel">關閉面板 <i class="i-close"></i></div></div><h3>設定</h3><div class="position-relative w-100"><div ld-each="tab"><div class="config mb-4" ld-each="ctrl"></div></div></div></div><div class="side-panel" ld-scope="" ld="panel" data-name="detail"><div class="text-right mb-4"><div class="btn btn-sm btn-outline-secondary" ld="close-panel">關閉面板 <i class="i-close"></i></div></div><h3 class="w-100 border-bottom border-dark pb-2 mb-2 text-right text-hl" ld="cat2">...</h3><p class="text-right mb-4" ld="cat1"></p><div class="mb-4" style="display:grid;gap:.25em;grid-template-columns:1fr 1fr 2.2em"><div>產值</div><div class="text-right text-hl" ld="value" data-name="產值">0</div><div class="text-left">億元</div><div>出口值</div><div class="text-right text-hl" ld="value" data-name="出口值">0</div><div class="text-left">億元</div><div>就業人數</div><div class="text-right text-hl" ld="value" data-name="就業人數">0</div><div class="text-left">人</div><div>營利事業家數</div><div class="text-right text-hl" ld="value" data-name="家數">0</div><div class="text-left">家</div></div><h5 class="text-right pt-4"><span ld="dimension"></span>歷年走勢</h5><div class="aspect-ratio ratio-2by1"><div class="rounded p-2 position-relative" style="background:rgba(0,0,0,.5)" ld="detail-chart"><div class="position-absolute w-100 h-100 z-fixed" ld="detail-chart-disabled" style="top:0;left:0"><div class="d-flex align-items-center justify-content-center w-100 h-100 bg-dark" ld="detail-chart-disabled"><span>資料不足，無法顯示走勢</span></div></div></div></div></div><div class="side-panel active" ld="panel" data-name="overview"><a class="logo text-white mb-2" href="https://taicca.tw/" rel="noopener noreferrer">&#x00ab; 文化內容策進院</a><h3 class="border-bottom border-dark pb-2 mb-3">文化內容產業概況</h3><div class="d-flex clickable mb-3" style="line-height:1em;margin-right:-.5em;color:#ddd"><div class="p-2 mr-2 rounded" ld="dimension-tab" data-name="產值">產值</div><div class="p-2 rounded" ld="dimension-tab" data-name="出口值">出口值</div><div class="p-2 mr-2 rounded" ld="dimension-tab" data-name="就業人數">就業人數</div><div class="p-2 mr-2 rounded" ld="dimension-tab" data-name="家數">家數</div></div><div class="mb-4 text-lg text-right pnl w-100 pt-3"><div class="dropright text-sm" ld="dropdown"><div class="text-sm dropdown-toggle clickable" data-toggle="dropdown"><span ld="year"></span> 年</div><div class="dropdown-menu shadow"><div class="dropdown-item" ld-each="year-item"></div></div></div><div>產業總<span ld="dimension">就業人數</span></div><div class="d-flex justify-content-end align-items-baseline"><h1 class="m-0" style="line-height:1em" ld="value" data-name="總數">0</h1><div class="text-sm" ld="unit">人</div></div></div><div class="text-lg mb-2">子產業</div><div class="w-100" style="display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:1em"><div class="text-right pnl hover d-flex align-items-stretch justify-content-between" style="padding:.75em"><div class="rounded mr-2" ld="cat-color" data-name="遊戲" style="width:.75em;height:100%;background:#d55741"></div><div class="text-right"><div>遊戲</div><div class="d-flex justify-content-end align-items-baseline"><div class="m-0" style="font-weight:700;font-size:1.25em;line-height:1em" ld="value" data-name="遊戲">0</div><div class="text-nowrap" style="font-size:10px" ld="unit">人</div></div></div></div><div class="text-right pnl hover d-flex align-items-stretch justify-content-between" style="padding:.75em"><div class="rounded mr-2" ld="cat-color" data-name="流行音樂" style="width:.75em;height:100%;background:#e8c05c"></div><div class="text-right"><div>流行音樂</div><div class="d-flex justify-content-end align-items-baseline"><div class="m-0" style="font-weight:700;font-size:1.25em;line-height:1em" ld="value" data-name="流行音樂">0</div><div class="text-nowrap" style="font-size:10px" ld="unit">人</div></div></div></div><div class="text-right pnl hover d-flex align-items-stretch justify-content-between" style="padding:.75em"><div class="rounded mr-2" ld="cat-color" data-name="影視" style="width:.75em;height:100%;background:#7febb2"></div><div class="text-right"><div>影視</div><div class="d-flex justify-content-end align-items-baseline"><div class="m-0" style="font-weight:700;font-size:1.25em;line-height:1em" ld="value" data-name="影視">0</div><div class="text-nowrap" style="font-size:10px" ld="unit">人</div></div></div></div><div class="text-right pnl hover d-flex align-items-stretch justify-content-between" style="padding:.75em"><div class="rounded mr-2" ld="cat-color" data-name="出版" style="width:.75em;height:100%;background:#577aeb"></div><div class="text-right"><div>出版</div><div class="d-flex justify-content-end align-items-baseline"><div class="m-0" style="font-weight:700;font-size:1.25em;line-height:1em" ld="value" data-name="出版">0</div><div class="text-nowrap" style="font-size:10px" ld="unit">人</div></div></div></div></div><div class="text-sm mt-4"><span>您也可以使用 <span class="text-primary clickable" ld="ldcv-popup" data-name="sheet">表格</span> 檢視資料，或者針對產業次類別做 <span class="text-primary clickable" ld="ldcv-popup" data-name="group">重整</span>。</span></div></div></div><div id="main-panel"><div class="aspect-ratio ratio-1by1 rounded-lg shadow-sm" style="background:rgba(0,0,0,.2)"><div class="d-none" ld="content" data-name="list"><div class="main-panel-inner" ld="container"><div class="d-flex mb-2 align-items-center"><div class="flex-grow-1 d-flex"><div class="dropdown d-mdh-none"><div class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown">顯示模式</div><div class="dropdown-menu shadow-sm"><div class="dropdown-item" ld="toggle-chart" data-name="treemap">圖表檢視</div><div class="dropdown-item" ld="ldcv-popup" data-name="sheet">表格檢視</div></div></div><div class="mr-2 d-none d-mdh-block"><div class="btn btn-sm btn-primary" ld="toggle-chart" data-name="treemap">圖表檢視</div><div class="btn btn-sm btn-text" ld="ldcv-popup" data-name="sheet">表格檢視</div></div><div class="btn btn-sm btn-text mr-2" ld="toggle-panel" data-name="config">設定</div><div class="dropdown"><div class="btn btn-sm btn-text dropdown-toggle" data-toggle="dropdown">下載</div><div class="dropdown-menu shadow text-sm dropdown-menu-right"><div class="dropdown-item" ld="download" data-type="svg">SVG</div><div class="dropdown-item" ld="download" data-type="png">PNG</div><div class="dropdown-item" ld="download" data-type="csv">CSV</div><div class="dropdown-item" ld="download" data-type="zip">ZIP</div></div></div></div><a class="btn btn-sm btn-text" ld="toggle-panel" data-name="overview"><span>產業概況</span> <i class="i-chevron-right"></i></a></div><div class="w-100" style="display:flex;flex-direction:column;flex:1 0 100px"><div class="d-flex py-2 justify-content-center"><div class="btn btn-sm btn-outline-secondary mx-2 text-sm" ld-each="subdim"></div></div><div ld="list-chart" style="flex:1 0 100px"></div><div class="my-1 mx-4 py-1 px-2 rounded" ld="list-chart-comment" style="white-space:pre-wrap;font-size:12px"></div></div></div></div><div ld="content" data-name="overview"><div class="main-panel-inner" ld="container"><div class="d-flex mb-2 align-items-center"><div class="flex-grow-1 d-flex"><div class="dropdown d-mdh-none"><div class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown">顯示模式</div><div class="dropdown-menu shadow-sm"><div class="dropdown-item" ld="toggle-chart" data-name="treemap">分組比較</div><div class="dropdown-item" ld="toggle-chart" data-name="bubble">整體比較</div><div class="dropdown-item" ld="toggle-chart" data-name="line">歷年走勢</div><div class="dropdown-item" ld="toggle-chart" data-name="bump">歷年順位</div><div class="dropdown-item" ld="ldcv-popup" data-name="sheet">表格檢視</div></div></div><div class="mr-2 d-none d-mdh-block"><div class="btn btn-sm btn-primary" ld="toggle-chart" data-name="treemap">分組比較</div><div class="btn btn-sm btn-text" ld="toggle-chart" data-name="bubble">整體比較</div><div class="btn btn-sm btn-text" ld="toggle-chart" data-name="line">歷年走勢</div><div class="btn btn-sm btn-text" ld="toggle-chart" data-name="bump">歷年順位</div><div class="btn btn-sm btn-text mr-2" ld="ldcv-popup" data-name="sheet">表格檢視</div></div><div class="btn btn-sm btn-text mr-2" ld="toggle-panel" data-name="config">設定</div><div class="dropdown"><div class="btn btn-sm btn-text dropdown-toggle" data-toggle="dropdown">下載</div><div class="dropdown-menu shadow text-sm dropdown-menu-right"><div class="dropdown-item" ld="download" data-type="svg">SVG</div><div class="dropdown-item" ld="download" data-type="png">PNG</div><div class="dropdown-item" ld="download" data-type="csv">CSV ( 完整資料 )</div><div class="dropdown-item" ld="download" data-type="csv" data-subtype="partial">CSV ( 客製檢視資料 )</div><div class="dropdown-item" ld="download" data-type="zip">ZIP</div></div></div></div><a class="btn btn-sm btn-text" ld="toggle-panel" data-name="list"><span>詳細統計數據</span> <i class="i-chevron-right"></i></a></div><div class="w-100" ld="chart" style="flex:1 0 100px"></div></div></div></div></div></div><div class="p-4 text-white footer text-center"><div class="my-4"><a class="d-block mb-4 mx-auto" href="https://taicca.tw" rel="noopener noreferrer"><img src="/assets/img/logo/footer.svg" alt="taicca logo" width="285px" height="29px" style="max-width:90%;width:450px;height:auto"></a><div>105402 台北市松山區民生東路三段158號5樓 <a href="https://goo.gl/maps/KiMW8eZCXnnwVYB99" rel="noopener noreferrer"><i class="i-location"></i></a></div><div>5F, No. 158, Sec 3, Minsheng E. Rd., Songshan Dist., Taipei City 105402, Taiwan </div><div>TEL (02) 2745-8186 FAX (02) 2749-2436</div><div class="mt-4 font-weight-bold mb-2">聯繫我們</div><div><a href="https://taicca.tw/page/contact" rel="noopener noreferrer"><i class="i-mail"></i></a><a class="mx-4" href="https://www.facebook.com/taicca.tw" rel="noopener noreferrer"><i class="i-fb"></i></a><a href="https://twitter.com/TAICCA_Official" rel="noopener noreferrer"><i class="i-twt"></i></a></div></div></div></div><div class="position-fixed ld ldld m-auto d-flex justify-content-center px-3" ld="hint" style="width:fit-content;bottom:2em;left:0;right:0;z-index:6000;pointer-events:none"><div class="alert alert-warning shadow-sm d-inline-block" style="pointer-events:all"><div class="d-flex"><div class="flex-grow-1 mr-4"><span class="mr-4">部份類別沒有資料，所以未呈現在圖表中。您可以參考 <span class="text-primary clickable" ld="ldcv-popup" data-name="sheet">表格檢視</span> 以了解更完整的資料樣貌。</span></div><button class="close" ld="hint-close">&times;</button></div></div></div><div class="ldcv" ld="sheet ldcv" data-name="sheet"><div class="base w-1024 rwd" style="height:80%;max-height:80%"><div class="inner"><div class="p-2 d-flex"><div class="flex-grow-1"><input class="form-control form-control-sm" ld="search" placeholder="關鍵字搜尋 ..."></div><div class="ml-2"><div class="btn btn-sm btn-outline-secondary d-flex align-items-center" data-ldcv-set="">關閉表格 <i class="i-close"></i></div></div></div><div ld="sheet"></div></div></div></div><style type="text/css">[ld~=group-scope] .list-group-item.active input{color:#fff}</style><div class="ldcv" ld-scope="" ld="ldcv group-scope" data-name="group"><div class="base" style="max-width:1024px;width:90%;height:90%"><div class="inner d-flex flex-column"><div class="px-4 py-3 d-flex border-bottom"><div class="font-weight-bold flex-grow-1">客製分組</div><div class="mr-4 d-flex align-items-center clickable" ld="switch-line"><div class="mr-1">啟用</div><div class="switch" ld="switch" data-name="enabled"></div></div><div class="mr-3 d-flex align-items-center clickable" ld="switch-line"><span class="mr-1">顯示未選取的分類</span><div class="switch" ld="switch" data-name="show-other"></div></div><div class="mr-3 d-flex align-items-center clickable" ld="switch-line"><span class="mr-1">顯示客製分組的細項</span><div class="switch" ld="switch" data-name="show-detail"></div></div></div><div class="d-flex flex-grow-1" style="overflow:hidden"><div class="d-flex flex-column border-right position-relative bg-white" style="flex:0 0 auto;min-width:12em;width:30%;z-index:1"><div class="flex-grow-1 overflow-scroll d-flex flex-column list-group rounded-0"><div class="px-4 py-3 border-bottom list-group-item" ld-each="custom-group"><div class="d-flex align-items-center" ld="root"><div class="flex-grow-1"><input class="border-0 w-100" value="我的分組" style="background:none;outline:0" ld="name"></div><div class="text-danger" ld="remove"><i class="i-close"></i></div></div></div><div class="px-4 py-3 d-flex clickable" ld="new-group"><div>新增...</div></div><div class="flex-grow-1"></div><div class="px-4 py-3"><div class="btn btn-sm btn-outline-secondary mr-2" ld="group-set">確定</div><div class="btn btn-sm btn-outline-secondary" ld="group-cancel">取消</div></div></div></div><div class="flex-grow-1 h-100 d-flex flex-column position-relative"><div class="border-bottom d-flex shadow-sm" style="padding:.85em 1em"><div class="flex-grow-1"><div class="btn btn-sm btn-outline-secondary mr-2" ld="select-all">全選</div><div class="btn btn-sm btn-outline-secondary" ld="select-none">全不選</div></div></div><div class="flex-grow-1" style="overflow:hidden"><div class="h-100 p-3" style="overflow:scroll"><div class="d-flex flex-wrap justify-content-between"><div class="entry shadow-sm p-2 rounded m-2 flex-grow-1 text-center no-select" ld-each="ccat"></div></div></div></div></div></div></div></div></div><script>if(/MSIE|Trident/.exec(navigator.userAgent)) { window.location.href = "/err/ie/" };</script><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=ResizeObserver" defer></script><script type="text/javascript" src="/assets/lib/i18next/main/dist/umd/i18next.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/ldquery/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldview/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/lderror/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/debounce.js/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/bootstrap.native/main/dist/bootstrap-native-v4.min.js" defer></script><script type="text/javascript" src="/assets/lib/papaparse/main/papaparse.min.js" defer></script><script type="text/javascript" src="/assets/lib/csv4xls/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/proxise/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/semver/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/csscope/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/rescope/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/block/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/konfig/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/konfig/main/konfig.widget.bootstrap.js" defer></script><script type="text/javascript" src="/assets/lib/ldcolor/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldcover/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldloader/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldslider/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/ldcolorpicker/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldpalettepicker/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldpalettepicker/main/all.palettes.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/sheet/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldfile/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/smiltool/main/smiltool.min.js" defer></script><script type="text/javascript" src="/assets/lib/jszip/main/dist/jszip.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/vscroll/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/datum/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/utils/tint.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/utils/config.min.js" defer></script><script type="module">var metacsv;metacsv=function(r){r==null&&(r={});return new Promise(function(e,n){var t;t=r.url?ld$.fetch(r.url,{method:"GET"},{type:"text"}):typeof r==="string"?r:r.raw?r.raw:null;if(!t){return n(new Error("invalid argument in metacsv"))}return t.then(function(t){t=t.trim();return Papa.parse(t).data}).then(function(t){var r,e,i,u;r=t.slice(6,7)[0];e=t.slice(7).map(function(n){return Object.fromEntries(r.map(function(t,e){return[t,n[e]]}))});i={head:r,body:e,sheet:[r].concat(t.slice(7)),unit:Object.fromEntries(t.slice(4,5)[0].map(function(t,e){return[r[e],t]})),mag:Object.fromEntries(t.slice(5,6)[0].map(function(t,e){return[r[e],t]})),meta:t.slice(0,6)};u=datum.type.get(i);i.type=Object.fromEntries(i.head.map(function(e,t){var n,r;n=i.meta[3][t];if(n==="T"){n="O"}r=!n?u.filter(function(t){return t.key===e})[0]:null;if(!r){r={type:n,types:Object.fromEntries([[n,1]])}}if(r.types.I===1){r.types.R=.5}return[e,r]}));return i}).then(function(t){return e(t)})["catch"](function(t){return n(t)})})};(function(t){return t.apply({})})(function(){var i,t,e;i={t1:Date.now()};t={palette:{colors:["#d55741","#e8c05c","#7febb2","#577aeb","#aaaaaa"],maps:["遊戲","流行音樂","影視","出版"].concat([["其它","樣貌"]])}};e={initing:true,ldcv:{},view:{},config:t,data:null,summary:null,groups:{cur:[],edit:[],active:null,cfg:{"show-detail":true,enabled:true}},chart:{block:"treemap",name:"treemap"},year:109,panelToggled:"overview",mode:"overview",years:[],list:{data:{},chart:{},subdim:[]},init:function(){var t,e,n=this;import$(this,{dimension:"產值"});this.tint=new chart.utils.tint({pal:this.config.pal,unique:false});t={block:function(t){var e,n;e=t.name,n=t.version;return"/assets/block/"+e+"/"+n+"/index.html"},module:function(t){var e,n,i;e=t.name,n=t.version,i=t.path;if(!/^d3/.exec(e)){return"/assets/lib/"+e+"/"+n+"/"+i}return"/assets/lib/"+e+"/main/"+i}};e=new rescope({prejs:["https://polyfill.io/v3/polyfill.min.js?features=ResizeObserver"],registry:t.module});return e.init().then(function(){n.manager=new block.manager({registry:function(t){var e,n,i,r;e=t.name,n=t.version,i=t.path,r=t.type;return r==="block"?"/assets/block/"+e+"/"+n+"/index.html":!/^d3/.exec(e)?"/assets/lib/"+e+"/"+n+"/"+i:"/assets/lib/"+e+"/main/"+i},rescope:e});return n.manager.init()}).then(function(){return i18next.init({supportedLng:["en","zh-TW"],fallbackLng:"zh-TW"})}).then(function(){return block.i18n.use(i18next)}).then(function(){return n.initView()}).then(function(){return metacsv({url:"/assets/data/ci/產業樣貌.csv"})}).then(function(t){return n.data=t}).then(function(){n.years=Array.from(new Set(n.data.body.map(function(t){return+t["年度"]}).filter(function(t){return t})));n.years.sort(function(t,e){return t-e});return n.data.body.map(function(e,t){["年度","家數","就業人數","產值","出口值"].map(function(t){return e[t]=+(e[t]+"").replace(/,/g,"")});return e._idx=t})}).then(function(){return n.summarizeData()}).then(function(){return n.initSheet()}).then(function(){return n.initConfig()}).then(function(){return n.initGroup()}).then(function(){return n.initList()}).then(function(){return n.load({name:n.chart.name,data:{delayRender:true}})}).then(function(){return n.initing=false}).then(function(){return n.view.main.render()}).then(function(){return console.log("[perf] startup elapsed time: "+((Date.now()-i.t1)/1e3).toFixed(2)+"s")})},summarizeData:function(){var t,e,o=this;t=this.data.body.filter(function(t){return+t["年度"]===o.year}).filter(function(t){return t["產業別"]==="遊戲"}).map(function(t){return t["就業人數"]});e=Object.fromEntries(["家數","就業人數","產值","出口值"].map(function(r){var n,i,a;n=o.data.body.filter(function(t){return+t["年度"]===o.year}).reduce(function(t,e){var n,i;n=e["產業別"];i=parseFloat(e[r]);if(isNaN(i)){i=0}t[n]=(t[n]||0)+i;return t},{});n["總數"]=function(){var t,e=[];for(i in t=n){a=t[i];e.push(a)}return e}().reduce(function(t,e){return t+e},0);return[r,n]}));return this.summary=e},bind:function(){var n,t,e,i,r,a,o,u,s,l,c,d,f,h=this;n=this.data;t=this.data.body.filter(function(t){return+t["年度"]===h.year});this.partialData=null;if(this.groups.enabled()){if(!this.groups.cfg["show-detail"]){n=datum.group({data:this.data,cols:["年度","產業別","主分類","次分類"],groupFunc:function(n){var t;t=h.groups.cur.filter(function(t){return t.list.filter(function(e){return!["主分類","次分類","產業別"].filter(function(t){return e[t]!==n[t]}).length}).length>0});if(t.length||!h.groups.cfg["show-other"]){return t.map(function(t){return{"年度":n["年度"],"產業別":t?t.name:"","主分類":t?t.name:"","次分類":t?t.name:""}})}else{return{"年度":n["年度"],"產業別":n["產業別"],"主分類":n["主分類"],"次分類":n["次分類"]}}},aggregator:{"家數":datum.agg.sum,"就業人數":datum.agg.sum,"產值":datum.agg.sum,"出口值":datum.agg.sum,"主分類":function(){return"-"},"次分類":function(){return"-"},"年度":datum.agg.first}})}else{n=import$({},this.data);n.body=[];for(e=0,i=this.data.body.length;e<i;++e){r=e;a=this.data.body[r];o=import$({},a);u=this.groups.cur.filter(g);if(!u.length){if(this.groups.cfg["show-other"]){n.body.push(o)}}else{u.map(m)}}}t=n.body.filter(function(t){return+t["年度"]===h.year});this.partialData={head:n.head,body:t}}if(this.chart.name==="bubble"){s={group:{key:"產業別"},area:{key:this.dimension,unit:this.data.unit[this.dimension]},name:{key:"次分類"}}}else if((l=this.chart.name)==="line"||l==="bump"){if(this.groups.enabled()){t=datum.pivot({data:n,col:"次分類",joinCols:["年度"]})}else{c={data:n,cols:["年度","主分類"],aggregator:{"產業別":datum.agg.first}};c.aggregator[this.dimension]=datum.agg.sum;t=datum.group(c);t=datum.pivot({data:t,col:"主分類",joinCols:["年度"]})}d=t.head.filter(function(t){return~t.indexOf("-"+h.dimension)});f=Object.fromEntries(d.map(function(t){return[t,t.split("-")[0]]}));t=datum.shrink({data:t,cols:d.concat(["年度"])});t=datum.rename({data:t,map:f});t=t.body;s={value:d.map(function(t){return{key:f[t],unit:h.data.unit[h.dimension]}}),order:{key:"年度",unit:"年"}}}else{s={color:{key:"產業別"},area:{key:this.dimension,unit:this.data.unit[this.dimension]},category:{key:"產業別"},name:{key:"次分類"}}}return{raw:t,binding:s};function g(t){return t.list.filter(function(e){return!["主分類","次分類","產業別"].filter(function(t){return e[t]!==a[t]}).length}).length>0}function m(t){var e;return n.body.push((e=import$({},o),e["產業別"]=t.name,e))}},_load:function(t){var e,n,i;e=t.name,n=t.data,i=t.root;return this.manager.get({name:e,version:"0.0.1"}).then(function(t){return t.create({data:n})}).then(function(t){return t.attach({root:i}).then(function(){return t["interface"]()})})},reload:function(){var t;if((t=this.chart.name)==="treemap"||t==="bubble"){this.chart.obj.config({legend:{enabled:this.groups.enabled(),selectable:true}})}this.chart.obj.setRaw(this.bind());return this.view.main.render("download")},load:function(t){var e,n,i,r,a,o=this;e=t.name,n=t.data;this.chart.name=this.chart.block=e;i={};if(e==="bump"){this.chart.block=e="line";i.mode="bump";r=i.legend||(i.legend={});r.enabled=true;r.selectable=true}if(e==="line"){(i.xaxis||(i.xaxis={})).enabled=true;(i.yaxis||(i.yaxis={})).enabled=true;((r=i.yaxis).tick||(r.tick={})).boundaryOffset=false;r=i.legend||(i.legend={});r.enabled=true;r.selectable=true}if(e==="treemap"){(i.legend||(i.legend={})).enabled=false;(i.unit||(i.unit={})).position="inner"}a=this.view.main.get("chart");if(this.chart.obj){this.chart.obj.destroy()}a.textContent="";return this._load({name:e,data:n,root:a}).then(function(t){var e,n;o.chart.obj=t;t.config(import$({palette:o.config.palette},i));if((e=o.chart.name)==="treemap"||e==="bubble"){t.config({legend:{enabled:o.groups.enabled(),selectable:true}})}t.setRaw(n=o.bind());t.on("select",function(t){return o.select(t)});t.on("hover",function(t){if(o.selected){return o.select(t)}});return o.view.main.render("download")})},toggleCover:function(t){this.ldcv[t].toggle();if(this.mode==="overview"){this.sheet.data(this.data.sheet)}else{this.sheet.data(this.list.data.sheet)}return this.sheet.obj.goto({row:0,col:0})},togglePanel:function(t){var e,n,i;t==null&&(t="overview");this.panelToggled=t;if(t==="overview"){this.mode="overview"}else if(t==="list"){this.mode="list"}for(e in n=this.panel){i=n[e];i.classList.toggle("active",e===t)}if(t!=="detail"){this.selected=null}this.view.main.render("content");this.reconfig();return this.regrid()},select:function(t){this.selected=t?t[0].data:null;this.togglePanel(this.selected?"detail":"overview");if(this.selected){return this.view.detail.render()}},initView:function(){var n,g=this;this.view.common={action:{click:{"toggle-panel":function(t){var e;e=t.node;return g.togglePanel(e.getAttribute("data-name"))},"close-panel":function(t){var e;e=t.node;return g.togglePanel(g.mode)},"ldcv-popup":function(t){var e;e=t.node;return g.toggleCover(e.getAttribute("data-name"))}}}};this.view.main=n=new ldview({root:document.body,initRender:false,init:{ldcv:function(t){var e;e=t.node;return g.ldcv[e.getAttribute("data-name")]=new ldcover({root:e})},dropdown:function(t){var e;e=t.node;return new BSN.Dropdown(e)},hint:function(t){var e,n;e=t.node;n=new ldloader({root:e});n.toggle(true);return setTimeout(function(){return n.toggle(false)},1e4)}},action:{click:import$(import$({},this.view.common.action.click),{"toggle-chart":function(t){var e;e=t.node;g.load({name:e.getAttribute("data-name"),data:{delayRender:true}});return g.view.main.render("toggle-chart")},"dimension-tab":function(t){var e;e=t.node;g.dimension=e.getAttribute("data-name");return n.render()},"hint-close":function(t){var e;e=t.node;g.view.main.get("hint").classList.toggle("d-none",true);return g.view.main.get("hint").classList.toggle("d-flex",false)},download:function(t){var e,i,a,o,u,s,n,r,l,c,d,f,h;e=t.node;i=e.getAttribute("data-type");a={};o={url:"/assets/img/logo/watermark-sm.png",width:380,height:50};u={url:"/assets/img/qrcode-sm.png",width:50,height:50};s={padding:10};s.height=s.padding*2+o.height;n=g.view.main.get("chart");r=g.mode==="list"?g.list.data.sheet:g.data.sheet;if(i==="csv"&&e.getAttribute("data-subtype")==="partial"&&g.partialData){l=g.partialData;r=[l.head].concat(l.body.map(function(e){return l.head.map(function(t){return e[t]})}))}c=csv4xls.toArray(r);d=csv4xls.toHref(r);f=ld$.find(g.view.main.get(g.mode==="list"?"list-chart":"chart"),"svg",0);h=f.getBoundingClientRect();f=f.cloneNode(true);f.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");f.setAttribute("xmlns","http://www.w3.org/2000/svg");f.setAttribute("viewbox","0 0 "+h.width+" "+(h.height+s.height));f.setAttribute("width",h.width+"px");f.setAttribute("height",h.height+s.height+"px");return ldfile.fromURL(o.url,"dataurl").then(function(t){var e;e=t.result;a.logo=e;return ldfile.fromURL(u.url,"dataurl")}).then(function(t){var e,n,i,r;e=t.result;a.qrcode=e;n='<style type="text/css">\nsvg { background: #fff }\ntext { font-family: sans-serif; }\n.text-sm { font-size: .8em }\n</style>\n<image x="'+s.padding+'" y="'+(h.height+s.padding)+'"\nxlink:href="'+a.logo+'" width="'+o.width+'" height="'+o.height+'"/>\n<image x="'+(h.width-u.width-s.padding)+'" y="'+(h.height+s.padding)+'"\nxlink:href="'+a.qrcode+'" width="'+u.width+'" height="'+u.height+'"/>';i=f.outerHTML.replace("</svg>",n+"</svg>");a.svgXml=r='<?xml version="1.0" encoding="utf-8"?>\n'+i;return smiltool.svgToDataurl(i,h.width,h.height+s.height)}).then(function(t){return smiltool.urlToDataurl(t,h.width,h.height+s.height)}).then(function(t){return smiltool.dataurlToBlob(t)}).then(function(t){var e,n;switch(i){case"zip":e=URL.createObjectURL(t);n=new JSZip;n.file("result.csv",d.buffer);n.file("result.svg",a.svgXml);n.file("result.png",t);return n.generateAsync({type:"blob"}).then(function(t){return{blob:t,name:"result.zip"}});case"csv":return{blob:csv4xls.toBlob(r),name:"result.csv"};case"png":return{blob:t,name:"result.png"};case"svg":return{blob:new Blob([a.svgXml],{type:"image/svg+xml"}),name:"result.svg"}}}).then(function(t){var e,n;e=t.blob,n=t.name;return ldfile.download({blob:e,name:n})})}})},text:{year:function(){return g.year},dimension:function(){return g.dimension},value:function(t){var e,n,i,r,a;e=t.node;n=e.getAttribute("data-name");i=((r=g.summary)[a=g.dimension]||(r[a]={}))[n]||0;return i<1e4?i.toFixed(0):i<1e6?Math.round(i/1e4)+"萬":i<1e8?Math.round(i/1e6)+"百萬":Math.round(i/1e8)+"億"},unit:function(t){var e;e=t.node;return g.data.unit[g.dimension]},"list-chart-comment":function(){return g.list.comment||""}},handler:{subdim:{list:function(){if(g.list.subdim.length<=1){return[]}else{return g.list.subdim}},view:{text:{"@":function(t){var e;e=t.ctx;return e.list.length===1?e.key:e.list.slice(0,3).map(function(t){return t.key}).join(",")+" .. 等"+e.list.length+"項"}},handler:{"@":function(t){var e,n,i;e=t.ctx,n=t.node;i=g.list.subdimUsed&&g.list.subdimUsed.key===e.key;n.classList.toggle("btn-outline-secondary",!i);return n.classList.toggle("btn-primary",i)}},action:{click:{"@":function(t){var e,n;e=t.views,n=t.ctx;g.list.subdimUsed=n;g.renderList(g.list.picked);return e[1].render("subdim")}}}}},content:function(t){var e,n,i,r;e=t.node;n=e.getAttribute("data-name");return e.classList.toggle("d-none",!(i=n==="list")!==!(r=g.mode==="list")&&(i||r))},hint:function(){},sheet:function(){},download:function(t){var e;e=t.node;if(e.getAttribute("data-subtype")!=="partial"){return}return e.classList.toggle("disabled",!g.partialData)},"cat-color":function(t){var e;e=t.node;return e.style.background=g.tint.get(e.getAttribute("data-name"))},"toggle-chart":function(t){var e,n;e=t.node;n=e.getAttribute("data-name");e.classList.toggle("btn-primary",n===g.chart.name);return e.classList.toggle("btn-text",n!==g.chart.name)},chart:function(){return g.chart.obj.setRaw(g.bind())},"dimension-tab":function(t){var e,n;e=t.node;n=g.dimension===e.getAttribute("data-name");e.classList.toggle("btn-primary",n);return e.classList.toggle("text-white",n)},"year-item":{list:function(){return g.years},action:{click:function(t){var e,n;e=t.node,n=t.data;g.year=n;g.summarizeData();return g.view.main.render()}},handler:function(t){var e,n;e=t.node,n=t.data;return e.classList.toggle("active",g.year===n)},text:function(t){var e,n;e=t.node,n=t.data;return n}},loader:debounce(350,function(t){var e;e=t.node;return e.classList.toggle("running",g.initing)})}});this.panel=Object.fromEntries(this.view.main.getAll("panel").map(function(t,e){return[t.getAttribute("data-name"),t]}));this.view.detail=new ldview({root:this.panel.detail,action:{click:import$({},this.view.common.action.click)},init:{"detail-chart":function(t){var e,n;e=t.node,n=t.local;return g._load({name:"line",root:e,data:{delayRender:false}}).then(function(t){t.config({legend:{enabled:false},yaxis:{enabled:true},xaxis:{enabled:true}});t.resize();t.render();return n.chart=t})}},handler:{"detail-chart":function(t){var e,n,i,r,a,o;e=t.views,n=t.node,i=t.local;r=g.selected;if(!r){return}a=g.data.body.filter(function(e){return!["產業別","主分類","次分類"].filter(function(t){return e[t]!==r[t]}).length});o={value:[{key:g.dimension,unit:g.data.unit[g.dimension]}],order:{key:"年度"}};e[0].get("detail-chart-disabled").classList.toggle("d-none",a.map(function(t){return t[g.dimension]}).filter(function(t){return!isNaN(t)}).length>=2);return i.chart.setRaw({raw:a,binding:o})}},text:{dimension:function(){return g.dimension},cat1:function(){if(!g.selected){return}if(g.selected["次分類"]){return(g.selected["產業別"]||"")+" / "+(g.selected["主分類"]||"")}else{return(g.selected["產業別"]||"")+""}},cat2:function(){if(!g.selected){return}return g.selected["次分類"]||g.selected["主分類"]||""},value:function(t){var e,n,i;e=t.node;if(!g.selected){return}n=e.getAttribute("data-name");i=g.selected?g.selected[n]:0;return isNaN(i)?"(沒有資料)":i}}});return this.view.config=new ldview({root:this.panel.config,action:{click:this.view.common.action.click}})},regrid:function(){if(!this.sheet.obj){return}return this.sheet.obj.size(this.mode==="overview"?{col:["3em","5em","8em","13em","7em","7em","7em","7em"]}:{col:[]})},initSheet:function(t){var r=this;this.sheet={sort:{}};this.view.sheet=new ldview({root:this.view.main.get("sheet"),handler:{sheet:function(){}},action:{click:{"@":function(t){var e,n,i,o,u,s;e=t.node,n=t.evt;if(!(i=ld$.parent(n.target,".cell.frozen",e))){return}o=ld$.find(e,".cell.frozen").indexOf(i);u=r.sheet.sort[o]=(r.sheet.sort[o]||1)*-1;s=r.sheet.data();s.sort(function(t,e){var n,i,r,a;if(t===s[0]){return-1}if(e===s[0]){return 1}n=[t[o],e[o]],t=n[0],e=n[1];n=[t,e].map(function(t){if(!(t!=null)||t===""){return t=NaN}else{return+t}}),i=n[0],r=n[1];if(!(isNaN(i)||isNaN(r))){n=[i,r],t=n[0],e=n[1];a=t<e?-1:t>e?1:0;return a*u}if(isNaN(i)&&isNaN(r)){a=t<e?-1:t>e?1:0;return a*u}if(isNaN(i)){return 1}if(isNaN(r)){return-1}});r.sheet.obj.data(s.filter(function(t,e){if(!(e&&r.sheet.keyword)){return true}return~JSON.stringify(t).indexOf(r.sheet.keyword)}));return r.sheet.obj.renderSelection()}},input:{search:debounce(350,function(t){var e,n,i;e=t.node;r.sheet.keyword=n=e.value||"";i=r.sheet.data();return r.sheet.obj.data(i.filter(function(t,e){if(!(e&&n)){return true}return~JSON.stringify(t).indexOf(n)}))})}}});this.sheet.obj=new sheet({root:this.view.sheet.get("sheet"),frozen:{row:1},editing:false,size:{col:["3em","5em","8em","13em","7em","7em","7em","7em"]},class:{col:["","","","","text-right","text-right","text-right","text-right"]}});this.sheet.data=function(t){if(!(t!=null)){return r.sheet._data}r.sheet._data=t;return r.sheet.obj.data(t)};return this.sheet.data(this.data.sheet)},reconfig:function(){this.kfg.meta.group.hidden=this.mode!=="overview";this.kfg.main.build();return console.log("@plotdb/konfig rebuilt.")},initConfig:function(){var t,r=this;this.kfg={};this.kfg.main=t=new konfig({root:this.panel.config,view:"default",meta:this.kfg.meta={palette:{name:"配色",type:"palette",default:{colors:["#d55741","#e8c05c","#7febb2","#577aeb","#aaaaaa"]},palettes:ldpp.get("all").concat([{colors:["#B33425","#E95838","#EF683D","#55575A","#F3F3F3"],tag:["brand"],name:"taicca"},{colors:["#188A64","#707373","#EEF1F9"],tag:["concept"],name:"lin-yang-couple"}])},fontSize:{name:"字體大小",type:"number",range:false,default:{from:16},min:10,max:64,step:1},group:{name:"客製分組",type:"popup",popup:{get:function(){return r.ldcv.group.get()},data:function(t){if(t!=null){return r.groups.cur=t}else{return{text:"...",data:r.groups.cur}}}}}},manager:this.manager,useBundle:true,typemap:function(t){console.log(t,{name:"@plotdb/konfig",version:"main",path:t+""});return{name:"@plotdb/konfig",version:"main",path:"bootstrap/"+t}}});t.on("change",function(i){var t;r.config.palette=(t=import$({},i.palette),t.maps=["遊戲","流行音樂","影視","出版"].concat([["其它","樣貌"]]),t);r.tint=new chart.utils.tint({palette:r.config.palette,unique:false});[{root:r.view.main.get("chart"),chart:r.chart.obj},{root:r.view.main.get("list-chart"),chart:r.list.chart.obj}].map(function(t){var e,n;e=t.root,n=t.chart;e.style.fontSize=i.fontSize+"px";if(n){n.config({palette:r.config.palette});n.resize();return n.render()}});r.view.main.render("cat-color");if(r.view.list){return r.view.list.render(["picked-cat-color","data-item"])}});return t.init().then(function(){return console.log("@plotdb/konfig inited.")})},regroup:function(){},initGroup:function(){var e,t,n,i,r,a,o=this;e=this.data.body;t=Array.from(new Set(e.map(function(t){return t["產業別"]})));this.cats=n=t.map(function(i){var r,t;r=e.filter(function(t){return t["產業別"]===i});t=Array.from(new Set(r.map(function(t){return t["主分類"]})));return t.map(function(e){var t,n;t=r.filter(function(t){return t["主分類"]===e});return n=Array.from(new Set(t.map(function(t){return t["次分類"]}))).map(function(t){return{"次分類":t,"主分類":e,"產業別":i,"分類名":e+" / "+t}})}).reduce(function(t,e){return t.concat(e)},[])}).reduce(function(t,e){return t.concat(e)},[]).map(function(t,e){return t.idx=e,t});i=this.groups.cfg;this.groups.enabled=function(){return o.groups.cfg.enabled&&o.groups.cur.length};r=new WeakMap;return this.view.group=a=new ldview({root:this.view.main.get("group-scope"),action:{click:{"switch-line":function(t){var e,n;e=t.node;n=ld$.find(e,"[ld=switch]",0);n=n.getAttribute("data-name");i[n]=!i[n];return a.render("switch")},"new-group":function(){o.groups.edit.push(o.groups.active={name:"新分組",list:[]});return a.render()},"group-set":function(){o.groups.cur=o.groups.edit.map(function(t){return{name:t.name,list:t.list.map(function(t){return t})}});o.ldcv.group.set(o.groups.cur);a.render();return o.reload()},"group-cancel":function(){o.groups.edit=o.groups.cur.map(function(t){return{name:t.name,list:t.list.map(function(t){return t})}});o.ldcv.group.cancel();return a.render()},"select-all":function(t){var e;e=t.views;if(!o.groups.active){return}o.groups.active.list=n.map(function(t){return t});return e[0].render()},"select-none":function(t){var e;e=t.views;if(!o.groups.active){return}o.groups.active.list=[];return e[0].render()}}},handler:{ccat:{list:function(){return n},key:function(t){return t.idx},action:{mouseover:function(t){var e,n,i,r,a;e=t.views,n=t.data,i=t.evt;if(i.buttons===0){return}if(!o.groups.active){return}r=(a=o.groups.active).list||(a.list=[]);if(!in$(n,r)){r.push(n)}else{r.splice(r.indexOf(n),1)}return e[0].render()},mousedown:function(t){var e,n,i,r;e=t.views,n=t.data;if(!o.groups.active){return}i=(r=o.groups.active).list||(r.list=[]);if(!in$(n,i)){i.push(n)}else{i.splice(i.indexOf(n),1)}return e[0].render()}},handler:function(t){var e,n,i,r,a;e=t.node,n=t.data;i=o.tint.get(n["產業別"]);r=o.groups.active?(a=o.groups.active).list||(a.list=[]):null;a=e.style;a.background=i;a.color=ldcolor.hcl(i).l<63?"#fff":"#000";a.opacity=r&&~r.indexOf(n)?1:.3;e.textContent=n["分類名"];return e.setAttribute("data-key",n.idx)}},switch:function(t){var e,n;e=t.node;n=e.getAttribute("data-name");return e.classList.toggle("on",!!i[n])},"custom-group":{list:function(){return o.groups.edit},view:{handler:{name:function(t){var e,n;e=t.node,n=t.ctx;return e.value=n.name},root:function(t){var e,n;e=t.node,n=t.ctx;return e.parentNode.classList.toggle("active",o.groups.active===n)}},action:{input:{name:function(t){var e,n;e=t.node,n=t.ctx;return n.name=e.value}},click:{"@":function(t){var e,n;e=t.views,n=t.ctx;o.groups.active=n;o.view.group.render("ccat");return e[1].render("custom-group")},remove:function(t){var e;e=t.ctx;if(in$(e,o.groups.edit)){o.groups.edit.splice(o.groups.edit.indexOf(e))}return a.render()}}}}}}})},colormap:function(){},initColor:function(){var a,t;this.config.colormap=a={palette:{sel:"all",sort:"none"}};return t=new ldview({root:this.view.main.get("colormap-scope"),action:{click:{"set-pal":function(t){var e,n,i,r;e=t.views,n=t.node;i=n.getAttribute("data-type");r=n.getAttribute("data-name");a.palette[i]=r;return e[0].render()}}},handler:{"set-pal":function(t){var e,n,i;e=t.node;n=e.getAttribute("data-type");i=e.getAttribute("data-name");return e.classList.toggle("active",a.palette[n]===i)}}})},renderList:function(t){var w,y=this;this.list.picked=t;this.view.list.render();w=this.view.main.get("list-chart");return metacsv({url:"/assets/data/ci/"+t.path}).then(function(a){var t,e,o,n,i,u,r,s,l,c,d,f,h,g,m,p,v,b;y.list.comment=(a.meta[2]||[]).join("\n").trim();t=a.sheet;e=function(t){var e,n,i,r,a,o,u,s;n=[];for(i in r=t.type){a=r[i];n.push((a.key=i,a))}e=n;o=["I","R","N","C","O"];e.sort(function(t,e){t=o.indexOf(t.type);e=o.indexOf(e.type);if(t<e){return 1}else if(e<t){return-1}else{return 0}});u=e.map(function(t){return t.type});s=u.join("");return{list:e,codes:u,str:s}};o=e(a);n=(o.list.filter(function(t){return t.type==="O"})[0]||{}).key;i=Array.from(new Set(a.body.map(function(t){return t[n]}))).length;if(i===1){a=datum.shrink({data:a,cols:o.list.filter(function(t){return t.key!==n}).map(function(t){return t.key})})}u={};r=o.list.filter(function(t){var e;return!((e=t.type)==="I"||e==="R")}).map(function(t){return t.key});o.list.filter(function(t){var e;return(e=t.type)==="I"||e==="R"}).map(function(t,e){var n,i,r;n=a.unit[t.key]||"n/a";i=in$("C",o.codes)?u[r="force-group-"+e]||(u[r]={}):u[n]||(u[n]={});(i.list||(i.list=[])).push(t);i.unit=n;if(!i.key){return i.key=t.key}});y.list.subdim=function(){var t,e=[];for(s in t=u){l=t[s];e.push(l)}return e}();if(y.list.subdim.length){if(y.list.subdimUsed&&y.list.subdim.filter(function(t){return t.key===y.list.subdimUsed.key}).length){c=y.list.subdimUsed}else{c=y.list.subdimUsed=y.list.subdim[0]}a=datum.shrink({data:a,cols:r.concat(c.list.map(function(t){return t.key}))});o=e(a)}d=in$("O",o.codes)?"line":"treemap";if(o.list.length===2&&((f=o.str)==="NR"||f==="RN"||f==="CR"||f==="RC")){d="pie"}else if(o.list.length===2&&((f=o.str)==="NI"||f==="IN"||f==="CI"||f==="IC")){d="bar"}if(!in$("O",o.codes)&&o.codes.filter(function(t){return t==="C"||t==="N"}).length===1&&o.codes.filter(function(t){return t==="R"||t==="I"}).length===o.codes.length-1&&o.codes.length>2){d="bar"}if(in$("O",o.codes)&&o.codes.filter(function(t){return t==="C"}).length>=2){h=a.head.filter(function(t,e){return a.type[t]!=="C"});a=datum.shrink({data:a,cols:h})}if(~o.str.indexOf("C")&&~o.str.indexOf("O")){h=[];for(g=0,m=(f=["O","C","R","I"]).length;g<m;++g){p=f[g];for(s in v=a.type){l=v[s];if(l.type===p){h.push(s);break}}}a=datum.shrink({data:a,cols:h});a=datum.pivot({col:h[1],joinCols:[h[0]],simpleHead:true,data:a})}y.list.data=a;y.list.data.sheet=t;if(b=y.list.chart.name===d&&y.list.chart.obj){return b}else{if(y.list.chart.obj){y.list.chart.obj.destroy()}w.textContent="";y.list.chart.name=d;return y.manager.get({name:d,version:"0.0.1"}).then(function(t){return t.create({data:{delayRender:true}})}).then(function(t){return t.attach({root:w}).then(function(){return t["interface"]()})})}}).then(function(t){var e,i,r,n;y.view.main.render(["list-chart-comment","subdim"]);y.list.chart.obj=t;e=datum.type.bind(y.list.data,t.mod.dimension,function(){var t,e,n=[];for(i in t=this.list.data.type){r=t[i];n.push((e=import$({},r),e.key=i,e))}return n}.call(y));n={palette:y.config.palette,legend:{enabled:true,selectable:true},yaxis:{enabled:true,caption:{show:true}}};if(y.list.chart.name==="bar"){n.legend={selectable:false};n.sort={enabled:true,dir:"desc"};n.brush={enabled:false};n.xaxis={textWidth:1}}t.config(n);return t.setRaw({raw:y.list.data.body,binding:e})})["catch"](function(t){return console.log(t)})},initList:function(){var r=this;return ld$.fetch("/assets/data/ci/tables.json",{method:"GET"},{type:"json"}).then(function(t){var n;r.list.files=t.filter(function(t){return!/TODO|產業樣貌/.exec(t[t.length-1])}).map(function(t){return{cat:t[0],name:t[t.length-1],full:t[0]+" / "+t[t.length-1],path:t.join("/")+".csv"}});r.list.picked=r.list.files[0];r.view.list=n=new ldview({root:r.view.main.get("list-scope"),initRender:false,action:{input:{"dataset-search-field":debounce(300,function(t){var e;e=t.node;r.list.search=e.value;return n.render()})}},text:{"picked-cat":function(){if(!r.list.picked){return}return r.list.picked.cat},"picked-name":function(){if(!r.list.picked){return}return r.list.picked.name}},handler:{"picked-cat-color":function(t){var e;e=t.node;return e.style.background=r.tint.get(r.list.picked?r.list.picked.cat:"其它")},"no-data-item":function(t){var e,n;e=t.node;n=r.list.files.filter(function(t){return!r.list.search||~t.full.indexOf(r.list.search)}).length;return e.classList.toggle("d-none",n)},"data-item":{list:function(){return r.list.files},view:{action:{click:{"@":function(t){var e;e=t.ctx;return r.renderList(e)}}},text:{"dataset-name":function(t){var e;e=t.ctx;return e.name}},handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;return e.classList.toggle("active",r.list.picked===n)},"dataset-name":function(t){var e,n,i;e=t.node,n=t.ctx;e.textContent=n.name;i=!r.list.search||~n.full.indexOf(r.list.search);return e.parentNode.parentNode.classList.toggle("d-none",!i)},"dataset-color":function(t){var e,n;e=t.node,n=t.ctx;return e.style.background=r.tint.get(n.cat)}}}}}});r.renderList(r.list.picked);return null})}};return e.init()});function import$(t,e){var n={}.hasOwnProperty;for(var i in e)if(n.call(e,i))t[i]=e[i];return t}function in$(t,e){var n=-1,i=e.length>>>0;while(++n<i)if(t===e[n])return true;return false}</script></body></html>