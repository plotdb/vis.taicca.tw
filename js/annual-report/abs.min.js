var bandwidth=function(t){return t&&t.bandwidth?t.bandwidth():0},lg=!!/lg/.exec(window.location.search),springOpt=lg?{timing:.975,decay:.01,cycle:8}:{timing:.955,decay:.003,cycle:4},renderInterface={renderLine:function(t){var e,l,n,o,r,a,i,c=this;if(null==t&&(t={}),d3.select(this.svg.trend).selectAll("g.chart").data(["1"]).enter().append("g").attr("class","chart"),(e=d3.select(this.svg.trend).select("g.chart")).attr("filter","url(#lava)"),t&&(l=t.animate),!(this.bounce||(this.bounce={})).reset||1===l)return null==l?(l=1,(this.bounce||(this.bounce={})).reset=!0):(l*=springOpt.timing,(this.bounce||(this.bounce={})).reset=!1),.01<=l?(i=function(){return requestAnimationFrame(function(){if(c.renderLine)return c.renderLine({animate:l||1})})},1===l?setTimeout(i,1e3):i()):l=.01,n=.01<l&&!this.bounce.reset,o=((o=this.scale.y.domain())[1]-o[0])*springOpt.decay,r=function(t){for(var e,n,r,a,i=t.map(function(t){return t}),c=t.length-1;1<=c;--c)n=t[e=c],a=t[e-1],r=(n.y+a.y)/2+Math.sin(l*Math.PI*2*springOpt.cycle)*o*l,a={x:(n.x+a.x)/2,y:r},i.splice(e,0,a),isNaN(r)||(a.value=0,a.valueAlt=0);return i},a=d3.line().curve(d3.curveCardinal).defined(function(t){return!isNaN(t.value)&&!isNaN(t.valueAlt)}).x(function(t){var e=c.scale.x(Math.round(t.x));return e+=c.bipolar?0:bandwidth(c.scale.x)/2+bandwidth(c.scale.x)*(t.x-Math.round(t.x))}).y(function(t){return c.scale.y(t.y)}),t=function(t,e){return t=(n||e?t:t.transition().duration(350)).filter(function(t,e){return!t.deleted}).attr("d",function(t){return a(r(t.pts))}).attr("fill","none").attr("class",function(t,e){return c.bipolar&&c.active&&t.catname===c.active.catname?"line highlight":"line"}).attr("stroke",function(t){return c.scale.color(t.catname)}).attr("stroke-width",function(t,e){return c.active&&t.catname===c.active.catname?3:1}).attr("opacity",0),(n||!e?t:t.transition().duration(350)).filter(function(t,e){return!t.deleted}).attr("opacity",function(){return"proportion"===c.mode?0:1})},(i=e.selectAll("path.line").data(this.lines,function(t){return t.catname})).exit().each(function(t,e){return t.deleted=!0}).transition().duration(350).attr("opacity",0).remove(),t(i.enter().append("path"),!0),t(e.selectAll("path.line").filter(function(t){return!t.deleted})),(i=e.selectAll("ellipse.sparkle").data(this.lines,function(t){return t.catname})).exit().each(function(t,e){return t.deleted=!0}).transition().duration(350).attr("opacity",0).remove(),(t=function(t,e){return e&&t.each(function(t,e){return d3.select(this).append("animateMotion")}),t.attr("class","sparkle").attr("rx",3).attr("ry",2).attr("fill",function(t){return c.scale.color(t.catname)}).each(function(t,e){return d3.select(this).select("animateMotion").attr("id","ani"+e).attr("dur",0*e+1.5+"s").attr("begin","ani"+e+".end+"+(.01*e+1)+"s").attr("path",a(t.pts))})})(i.enter().append("ellipse"),!0),t(e.selectAll("ellipse.sparkle").filter(function(t){return!t.deleted}))},renderCircle:function(){var n=this,t=function(t,e){return t=(e?t:t.transition().duration(350)).filter(function(t,e){return!t.deleted}).attr("cx",function(t){return n.scale.x(t.x)+(n.bipolar?0:bandwidth(n.scale.x)/2)}).attr("cy",function(t){return"proportion"===n.mode?n.scale.py(t.percent.offset+t.percent.delta/2):n.scale.y(t.y)}).attr("r",function(t){return n.active&&t.key===n.active.key?10:5}).attr("fill",function(t){return n.scale.color(t.catname)}).attr("opacity",0),(e?t.transition().duration(350):t).filter(function(t,e){return!t.deleted}).attr("opacity",function(){return"proportion"===n.mode?0:1})},e=d3.select(this.svg.trend).selectAll("circle.ptr").data(this.ptsValid,function(t){return t.key});return e.exit().each(function(t,e){return t.deleted=!0}).transition().duration(350).attr("opacity",0).remove(),t(e.enter().append("circle").attr("class","ptr"),!0),t(d3.select(this.svg.trend).selectAll("circle.ptr").filter(function(t){return!t.deleted}))},renderRect:function(){var n=this,t=function(t,e){return t=(e?t:t.transition().duration(350)).attr("class","stack").attr("x",function(t){return n.scale.x(t.x)}).attr("y",function(t){return n.scale.py(t.percent.offset+t.percent.delta/2)}).attr("height",0).attr("width",function(){return n.bipolar?0:bandwidth(n.scale.x)}).attr("fill",function(t){return n.scale.color(t.catname)}).attr("opacity",0),(e?t.transition().duration(350):t).filter(function(t,e){return!t.deleted}).attr("y",function(t){return"proportion"!==n.mode?n.scale.py(t.percent.offset+t.percent.delta/2):n.scale.py(t.percent.offset)}).attr("height",function(t){return"proportion"!==n.mode?0:Math.abs(n.scale.py(t.percent.offset+t.percent.delta)-n.scale.py(t.percent.offset))}).attr("opacity",1)},e=d3.select(this.svg.trend).selectAll("rect.stack").data(this.ptsValid,function(t){return t.key});return e.exit().each(function(t,e){return t.deleted=!0}).transition().duration(350).attr("opacity",0).remove(),t(e.enter().append("rect").attr("class","stack"),!0),t(d3.select(this.svg.trend).selectAll("rect.stack").filter(function(t){return!t.deleted}))}};