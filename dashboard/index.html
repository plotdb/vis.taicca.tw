<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html;charset=UTF-8"><base href=".."><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1"><!-- Global site tag (gtag.js) - Google Analytics--><script async src="https://www.googletagmanager.com/gtag/js?id=G-HXVX4JRNGZ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HXVX4JRNGZ');</script><link rel="stylesheet" type="text/css" href="assets/lib/bootstrap/main/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldiconfont/main/ldif.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldslider/main/ldrs.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldloader/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldbutton/main/ldbtn.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldpalettepicker/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@loadingio/loading.css/main/loading.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@loadingio/transition.css/main/transition.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@loadingio/ldcolorpicker/main/ldcp.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@plotdb/sheet/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/clusterize.js/main/clusterize.css"><link rel="stylesheet" type="text/css" href="css/panel.css"><link rel="stylesheet" type="text/css" href="css/index.css"><link rel="stylesheet" type="text/css" href="assets/lib/@plotdb/chart/main/chart.min.css"><title>主題產業數據儀表板</title><style type="text/css">.header{display:flex;align-items:center}#root{height:100%}.dashboard{position:absolute;top:0;left:0;z-index:10;display:grid;padding:1em;gap:1em;width:100%;height:100%;perspective:1000px}.pnl.widget{padding-top:.5em;opacity:1;transform:rotate3d(0,1,0,0);transition:transform .35s ease-in-out,opacity .35s ease-in-out;z-index:1;position:relative}.pnl.widget.highlight{color:#f5faff}.pnl.widget.highlight.color{text-shadow:0 1px 1px rgba(0,0,0,0.3)}.pnl.widget.highlight.color-film{background:#b53d27}.pnl.widget.highlight.color-revenue{background:#dfa921}.pnl.widget.highlight.color-ticket{background:#31df46}.pnl.inactive{z-index:0;opacity:0}.dashboard.hide{z-index:1;pointer-events:none}.dashboard.hide .pnl.widget{transform:rotate3d(0,1,0,360deg);opacity:0}.dashboard.hide[data-name=tw] .pnl.widget{transform:rotate3d(0,1,0,-360deg)}.rank-list-item{border:1px solid transparent;border-radius:.25em;margin:0 0 .5em;transition:all .15s ease-in-out}.rank-list-item:hover{margin:-0.25em 0 .75em;box-shadow:0 3px 3px 1px rgba(0,0,0,0.2)}.hint{display:inline-block;font-size:12px;color:#fff}[data-name=title]{grid-column:1/-1;grid-row:1}@media(max-width:1200px){body{font-size:14px}}@media(max-width:1024px){body{overflow:scroll}.dashboard{position:static;grid-template-columns:1fr !important;grid-template-rows:auto}.dashboard .pnl{grid-area:auto !important;height:75vw}.header .unclickable{display:none}#root{height:auto}.dashboard.hide{display:none}}@media(max-width:800px){.header{flex-direction:column;text-align:center}.header>div{margin-bottom:.5em}}</style></head><body><div class="ldcv scroll text-dark" ld="ldcv" data-name="rank"><div class="base w-1024"><div class="inner card"><div class="card-body"><h3>電影票房總排名</h3><p>指定時間範圍內，國內外電影依總票房排名結果</p><hr><div class="mb-2 d-flex align-items-center justify-content-start"><div class="px-2 py-1 mr-2 text-right rounded" style="width:3em">排名</div><div class="px-2 py-1 mr-2 text-center rounded" style="width:6em">國別</div><div class="px-2 py-1 mr-2 text-center" style="width:8em">總票房 <small>(新臺幣)</small></div><div class="px-2 py-1 flex-grow-1">片名</div></div><div class="d-flex align-items-center justify-content-start rank-list-item py-1 px-1" ld-each="rank"><div class="px-2 py-1 mr-2 text-right bg-white" ld="rank" style="width:3em"></div><div class="px-2 py-1 text-white mr-2 text-center rounded" ld="country" style="width:6em"></div><div class="px-2 py-1 mr-2 text-right bg-light" style="width:8em"><span ld="revenue"></span><span>元</span></div><div class="px-2 py-1 bg-light flex-grow-1" ld="name"></div></div></div></div></div></div><div class="ldcv scroll" ld="ldcv" data-name="detail"><div class="base w-1024" style="height:80%;min-height:90%;"><div class="inner card"><div class="card-body p-0"><div class="p-2 d-flex"><div class="flex-grow-1"><input class="form-control form-control-sm" ld="detail-search" placeholder="關鍵字搜尋 ..."></div><div class="ml-2"><div class="btn btn-sm btn-outline-secondary d-flex align-items-center" data-ldcv-set="">關閉表格 <i class="i-close"></i></div></div></div><div ld="detail"></div></div></div></div></div><div class="w-100 ld ld-over-inverse running" id="root" ld="loader"><div class="ld" style="width:100%;height:100%;top:0;left:0;"><img style="left:0;right:0;margin:-2.5em auto 0;width:5em;height:5em;" src="/assets/img/loader.svg"><div style="width:max-content;left:0;right:0;margin:2.5em auto 0;text-align:center;"><div class="text-sm">程式載入中<br>請稍候 ...</div></div></div><div class="h-100 d-flex flex-column"><div style="padding:1em 1em 0"><div class="pnl" data-name="title"><div class="header"><div><div class="text-hl">主題產業數據儀表板</div><div class="text-sm text-white"><a class="text-white" href="https://taicca.tw" rel="noopener noreferrer">&#x00ab; 文化內容策進院</a><span>&nbsp;/ 策略研究處</span></div></div><div class="text-lg text-hl mx-4">每週電影票房資訊</div><div class="mr-4 unclickable has-tips"><span>出版產業</span><div class="hover-tip tip-sm">upcoming</div></div><div class="mr-4 unclickable has-tips"><span>流行音樂產業</span><div class="hover-tip tip-sm">upcoming</div></div><div class="mr-4 unclickable has-tips"><span>OTT</span><div class="hover-tip tip-sm">upcoming</div></div><div class="flex-grow-1"></div><div class="btn btn-light mr-2 text-nowrap" ld="show-rank">整體排名</div><div class="btn btn-light mr-2 text-nowrap" ld="show-detail">表格檢視</div><div class="dropdown"><div class="btn btn-light dropdown-toggle d-flex align-items-center" data-toggle="dropdown"><div>時段：</div><div class="mx-2" style="line-height:1em;white-space:pre" ld="date-range">近半年</div></div><div class="dropdown-menu dropdown-menu-right shadow-sm"><div class="dropdown-item" ld="date-preset" data-name="all">全部時段</div><div class="dropdown-item" ld="date-preset" data-name="1m">最近一個月</div><div class="dropdown-item" ld="date-preset" data-name="6m">最近半年</div><div class="dropdown-divider"></div><div class="dropdown-header">時段起點</div><div class="dropdown-item"><select class="form-control" ld="date-picker" data-type="start" style="width:9em"><option ld-each="date"></option></select></div><div class="dropdown-header">時段終點</div><div class="dropdown-item"><select class="form-control" ld="date-picker" data-type="end" style="width:9em"><option ld-each="date"></option></select></div></div></div><div class="dropdown"><div class="btn btn-light dropdown-toggle d-flex align-items-center ml-2" data-toggle="dropdown">下載</div><div class="dropdown-menu dropdown-menu-right"><div class="dropdown-header">原始資料</div><div class="dropdown-item" ld="download" data-name="all">全時段</div><div class="dropdown-item" ld="download" data-name="part">選定時段</div><div class="dropdown-divider"></div><div class="dropdown-header">篩選後之資料</div><div class="dropdown-item" ld="download" data-name="part-filter-tw">僅國片</div><div class="dropdown-item" ld="download" data-name="part-filter">國片及外片</div><div class="dropdown-header">註: 篩選資料中, 各部電影僅保留最終一筆數據</div></div></div></div></div></div><div class="position-relative" style="flex:1 0 500px"><div class="dashboard hide" ld="dashboard" data-name="tw"><div class="pnl widget d-flex flex-column align-items-center justify-content-center clickable trigger" ld="switch" data-target="all"><div>點擊此處了解</div><div class="text-lg font-weight-bold">外片+國片銷售狀況 <i class="i-chevron-right"></i></div></div><div class="pnl widget" ld-each="panel" data-name="tw"><div class="d-flex"><div class="title mb-0 flex-grow-1" ld="title"></div><div class="clickable" ld="toggle"></div></div><div class="chart" ld="chart"></div></div></div><div class="dashboard hide" ld="dashboard" data-name="all"><div class="pnl widget d-flex flex-column align-items-center justify-content-center clickable trigger" ld="switch" data-target="tw"><div>點擊此處了解</div><div class="text-lg font-weight-bold">台灣電影銷售狀況 <i class="i-chevron-right"></i></div></div><div class="pnl widget" ld-each="panel" data-name="all"><div class="title mb-0" ld="title"></div><div class="chart" ld="chart"></div></div></div></div></div><div class="position-fixed" style="right:1em;bottom:1em;font-size:12px;padding:.25em .5em;background:#222;color:#ccc;z-index:10;border-radius:3px;box-shadow:0 2px 4px rgba(0,0,0,.3)"><span>資料來源: <a href="https://www.tfi.org.tw/BoxOfficeBulletin/weekly" target="_blank" rel="noopener noreferrer">國影中心</a></span></div></div><div class="p-4 text-white footer text-center"><div class="my-4"><a class="d-block mb-4 mx-auto" href="https://taicca.tw" rel="noopener noreferrer"><img src="/assets/img/logo/footer.svg" alt="taicca logo" width="285px" height="29px" style="max-width:90%;width:450px;height:auto"></a><div>105402 台北市松山區民生東路三段158號5樓 <a href="https://goo.gl/maps/KiMW8eZCXnnwVYB99" rel="noopener noreferrer"><i class="i-location"></i></a></div><div>5F, No. 158, Sec 3, Minsheng E. Rd., Songshan Dist., Taipei City 105402, Taiwan </div><div>TEL (02) 2745-8186 FAX (02) 2749-2436</div><div class="mt-4 font-weight-bold mb-2">聯繫我們</div><div><a href="https://taicca.tw/page/contact" rel="noopener noreferrer"><i class="i-mail"></i></a><a class="mx-4" href="https://www.facebook.com/taicca.tw" rel="noopener noreferrer"><i class="i-fb"></i></a><a href="https://twitter.com/TAICCA_Official" rel="noopener noreferrer"><i class="i-twt"></i></a></div></div></div><script>if(/MSIE|Trident/.exec(navigator.userAgent)) { window.location.href = "/err/ie/" };</script><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=ResizeObserver" defer></script><script type="text/javascript" src="/assets/lib/i18next/main/umd/i18next.min.js" defer></script><script type="text/javascript" src="assets/lib/@loadingio/ldquery/main/ldq.min.js" defer></script><script type="text/javascript" src="assets/lib/ldview/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@loadingio/debounce.js/main/debounce.min.js" defer></script><script type="text/javascript" src="assets/lib/bootstrap.native/main/bootstrap-native-v4.min.js" defer></script><script type="text/javascript" src="assets/lib/papaparse/main/papaparse.min.js" defer></script><script type="text/javascript" src="assets/lib/csv4xls/main/csv4xls.min.js" defer></script><script type="text/javascript" src="assets/lib/proxise/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/csscope/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/rescope/main/index.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/block/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/konfig/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/konfig/main/konfig.widget.bootstrap.js" defer></script><script type="text/javascript" src="assets/lib/ldcolor/main/ldcolor.min.js" defer></script><script type="text/javascript" src="assets/lib/ldcover/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/ldloader/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/ldslider/main/ldrs.min.js" defer></script><script type="text/javascript" src="assets/lib/@loadingio/ldcolorpicker/main/ldcp.min.js" defer></script><script type="text/javascript" src="assets/lib/ldpalettepicker/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/ldpalettepicker/main/all.palettes.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/sheet/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/ldfile/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/smiltool/main/smiltool.min.js" defer></script><script type="text/javascript" src="assets/lib/jszip/main/jszip.min.js" defer></script><script type="text/javascript" src="assets/lib/clusterize.js/main/clusterize.min.js" defer></script><script type="text/javascript" src="assets/lib/@loadingio/vscroll/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/datum/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/chart/main/chart.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/chart/main/utils/tint.min.js" defer></script><script type="text/javascript" src="https://d3js.org/d3.v4.js" defer></script><script type="text/javascript" src="https://d3js.org/d3-array.v2.min.js" defer></script><script type="module">var dashboard,pal;dashboard={layout:{}};pal={colors:["#d55741","#e8c05c","#6ee97d","#7fb2eb","#577aeb","#b376ee"]};(function(t){return t.apply(dashboard)})(function(){var t,x,T,e=this;t={t1:Date.now()};this.pal=pal;this.inited=false;this.loading=false;this.subdata={};this.ldcv={};this.chart={};this.filters={};this.mode="tw";this.dates=x={picked:{},list:[]};T=function(t){var e,n;t==null&&(t=[]);t=t.map(function(t){return new Date(t).getTime()});t.sort(function(t,e){if(t<e){return-1}else if(t>e){return 1}else{return 0}});e=t.length;n=1;while(n<e){if(t[n]-t[n-1]>86400*8*1e3){t.splice(n,0,t[n-1]+86400*7*1e3);continue}else{n++}}t=t.map(function(t,e){var n,r;t=new Date(t);n=t.getYear()+1900;r=(t.getMonth()+1+"").padStart(2,"0");t=(t.getDate()+"").padStart(2,"0");return n+"/"+r+"/"+t});return t};import$(this,{init:function(){var t,e,u=this;t={module:function(t){var e,n,r,i;e=t.name,n=t.version,r=t.path,i=t.type;return i==="block"?"/assets/block/"+e+"/"+n+"/index.html":!/^d3/.exec(e)?"/assets/lib/"+e+"/"+n+"/"+r:"/assets/custom-lib/d3/"+e+".v"+n+".min.js"}};e=new rescope({prejs:["https://polyfill.io/v3/polyfill.min.js?features=ResizeObserver"],registry:t.module});return e.init().then(function(){u.mgr=new block.manager({registry:t.module,rescope:e});return i18next.init({supportedLng:["en","zh-TW"],fallbackLng:"zh-TW"})}).then(function(){return block.i18n.use(i18next)}).then(function(){return u.mgr.init()}).then(function(){return u.view=new ldview({root:document.body,initRender:false,action:{click:{"date-preset":function(t){var e,n,r,i,a;e=t.node;n=e.getAttribute("data-name");switch(n){case"all":r=u.dates.picked;r.start=u.dates.list[0];r.end=(i=u.dates.list)[i.length-1];break;case"1m":a=Date.now()-864e5*31;u.dates.picked.start=u.dates.list.filter(function(t){return new Date(t).getTime()>=a})[0]||(r=u.dates.list)[r.length-1];u.dates.picked.end=(r=u.dates.list)[r.length-1];break;case"6m":a=Date.now()-864e5*182;u.dates.picked.start=u.dates.list.filter(function(t){return new Date(t).getTime()>=a})[0]||(r=u.dates.list)[r.length-1];u.dates.picked.end=(r=u.dates.list)[r.length-1]}u.view.render("date-picker","date-range");return u.filter()},download:function(t){var e,n,r,i,a,s,o,l;e=t.node;n=e.getAttribute("data-name");r=x.picked.start||x.list[0];i=x.picked.end||(a=x.list)[a.length-1];s=u.raw.head;if(n==="part"){o=u.raw.body.filter(function(t){var e,n,r,i,a;e=[t["起計日"],t["迄計日"]],n=e[0],r=e[1];i=x.picked.start||x.list[0];a=x.picked.end||(e=x.list)[e.length-1];return n>=i&&n<=a&&r>=i&&r<=a})}else if(n==="part-filter-tw"){o=u.data.part.movie.tw}else if(n==="part-filter"){o=u.data.part.movie.all}else{o=u.raw.body}l=o.map(function(n){return s.map(function(t){var e;e=n[t];return e=Array.isArray(e)?e.join(","):!(e!=null)?"":e+""})});l=l.map(function(t){var e;e=t.slice(0,4);e[1]=e[1].replace(/^(..)/,"$1/");e[3]=e[3].replace(/^(..)/,"$1/");return[e[0]+"/"+e[1],e[2]+"/"+e[3]].concat(t.slice(4))});l=[["起計日","迄計日"].concat(s.slice(4))].concat(l);return ldfile.download({blob:csv4xls.toBlob(l),name:"result.csv"})},"date-picker":function(t){var e;e=t.evt;return e.stopPropagation()},"show-detail":function(){return u.ldcv.detail.toggle()},"show-rank":function(){return u.ldcv.rank.toggle()},switch:function(t){var e,n;e=t.node,n=t.views;u.mode=e.getAttribute("data-target");n[0].render("dashboard");return u.renderChart()},detail:function(t){var e,n,r,i,a,s;e=t.node,n=t.evt;if(!(r=ld$.parent(n.target,".cell",e))){return}if(!(i=ld$.find(r,"i",0))){return}a=+i.getAttribute("data-idx");s=u.sheetSort[a]=u.sheetSort[a]*-1;u.sheetData.sort(function(t,e){var n;if(typeof t[a]==="object"){return-1}else if(typeof e[a]==="object"){return 1}n=t[a]<e[a]?-1:t[a]>e[a]?1:0;return n*s});u.sheet.data(u.sheetData.filter(function(t,e){if(!(e&&u.sheetKeyword)){return true}return~JSON.stringify(t).indexOf(u.sheetKeyword)}));u.sheetHead.map(function(t,e){return ld$.find(t.node,"i",0).setAttribute("class","")});return i.classList.add(s>0?"i-dart-down":"i-dart-up")}},input:{"detail-search":debounce(350,function(t){var e,n;e=t.node;u.sheetKeyword=n=e.value||"";return u.sheet.data(u.sheetData.filter(function(t,e){if(!(e&&n)){return true}return~JSON.stringify(t).indexOf(n)}))})},change:{"date-picker":function(t){var e,n;e=t.node;n=e.getAttribute("data-type");u.dates.picked[n]=e.value;u.filter();return u.view.render("date-range")}}},init:{ldcv:function(t){var e;e=t.node;return u.ldcv[e.getAttribute("data-name")]=new ldcover({root:e})}},handler:{loader:function(t){var e;e=t.node;return e.classList.toggle("running",!u.inited||u.loading)},"date-range":function(t){var e,n;e=t.node;if(u.dates.picked.start===u.dates.list[0]&&u.dates.picked.end===(n=u.dates.list)[n.length-1]){e.textContent="全部";return e.classList.remove("text-sm")}else{e.textContent="由 "+u.dates.picked.start+"\n至 "+u.dates.picked.end;return e.classList.add("text-sm")}},"date-picker":function(t){var e,n;e=t.node;n=e.getAttribute("data-type");return e.value=u.dates.picked[n]},dashboard:function(t){var e,n,r,i;e=t.node;n=e.getAttribute("data-name");e.classList.toggle("hide",n!==u.mode);r=u.layout[n].grid;return i=e.style,i.gridTemplateColumns=r.col.join(" "),i.gridTemplateRows=r.row.join(" "),i},rank:{list:function(t){var e;e=t.node;return u.data.all.movie.all},view:{handler:{rank:function(t){var e,n,r;e=t.node,n=t.ctx,r=t.idx;return e.textContent=n.rank||1},name:function(t){var e,n;e=t.node,n=t.ctx;return e.textContent=n["中文片名"].substring(0,30)},country:function(t){var e,n,r;e=t.node,n=t.ctx;r=n["國別地區"];e.textContent=r.length>1?"多國":r[0];e.classList.toggle("bg-primary",in$("中華民國",r));return e.classList.toggle("bg-secondary",!in$("中華民國",r))},revenue:function(t){var e,n;e=t.node,n=t.ctx;return e.textContent=n["累計銷售金額"]}}}},panel:{list:function(t){var e,n,r;e=t.node;n=e.getAttribute("data-name");r=u.layout[n].panels;return r},key:function(t){return t.idx},view:{action:{click:{toggle:function(t){var e,n,r;e=t.views,n=t.ctx;r=u.layout[n.layout].panels.filter(function(t){return t.name===n.toggle.name})[0];n.active=false;r.active=true;return u.view.render()}}},text:{title:function(t){var e,n,r,i;e=t.ctx;return e.title||((n=(r=u.chart)[i=e.name]||(r[i]={})).info||(n.info={})).title||e.name},toggle:function(t){var e;e=t.ctx;if(!e.toggle){return}return e.toggle.text||e.toggle.name}},init:{chart:function(t){var e,n,r,i,a,s,o;e=t.node,n=t.ctx;r=n.name;i=n.chart||((a=(s=u.chart)[r]||(s[r]={})).info||(a.info={})).type;o=ld$.parent(e,".pnl");a=o.style;a.gridColumn=n.col[0]+" / span "+n.col[1];a.gridRow=n.row[0]+" / span "+n.row[1];if(n["class"]){n["class"].map(function(t){return o.classList.toggle(t,true)})}return(u.initPromise||(u.initPromise=[])).push(u.prepareChart({chart:i,name:r,root:e}))}},handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;return e.classList.toggle("inactive",n.active!=null&&!n.active)}}}},date:{list:function(){return u.dates.list||[]},handler:function(t){var e,n;e=t.node,n=t.data;e.textContent=n;e.setAttribute("value",n);if(u.dates.picked[e.parentNode.getAttribute("data-type")]===n){return e.setAttribute("selected",true)}}}}})}).then(function(){return u.getData()}).then(function(){return u.view.render()}).then(function(){return Promise.all(u.initPromise||[])})},prepareChart:function(t){var e,a,n,s,r,o=this;e=t.chart,a=t.name,n=t.root,s=t.config,r=t.data;return this.mgr.get({name:e,version:"0.0.1"}).then(function(t){return t.create({data:r})}).then(function(t){return t.attach({root:n,data:{delayRender:true}}).then(function(){return t["interface"]()})}).then(function(e){var t,n,r,i;(t=(n=o.chart)[a]||(n[a]={})).info||(t.info={});((t=o.chart)[a]||(t[a]={})).chart=e;r=import$(import$({},s||{}),((t=(n=o.chart)[a]||(n[a]={})).info||(t.info={})).cfg||{});if(!r.pal){r.pal=pal}e.config(r);e.on("filter",function(t){o.filter();o.filters[a]=t;if(o.chart[a].info.filter){return o.chart[a].info.filter({chart:e,filter:t})}});if(i=o.subdata[a]||o.chart[a].info.bind){return e.setRaw(i)}})},renderChart:function(){var t,e,n,r,i,a,s=[];for(t in e=this.chart){n=e[t];r=this.chart[t],i=r.chart,a=r.info;if(!(i&&a)){continue}if(a.dash!==this.mode){continue}i.resize();s.push(i.render())}return s},loaderWrap:function(t){var e=this;this.loading=true;this.view.render("loader");return debounce(100).then(function(){return t()}).then(function(){return debounce(300)}).then(function(){e.loading=false;return e.view.render("loader")})},filter:debounce(300,function(){var a=this;return this.loaderWrap(function(){return debounce(100).then(function(){var t,e,n,r,i;a.parse.tw.call(a.data.all,a.raw);a.parse.tw.call(a.data.part,a.raw,a.filters);for(t in e=a.chart){n=e[t];if(!(r=a.chart[t].chart)){continue}i=import$(a.chart[t].info,n.call(a.data.part,a.data,a.filters[t]));r.setRaw(i.bind);r.parse()}a.renderChart();a.view.render("rank");return debounce(300)})})}),parse:{tw:function(t,e){var n,r,i,a,s,o,l,u,d,c,h,f,p,v,m,g,w,b=this;n=t.head,r=t.body;this.movie={all:[],byCountry:{},continentmap:{},raw:{}};i={};a=x.picked.start||x.list[0];s=x.picked.end||(o=x.list)[o.length-1];r=r.filter(function(t){var e,n,r,i,a;e=[t["起計日"],t["迄計日"]],n=e[0],r=e[1];i=x.picked.start||x.list[0];a=x.picked.end||(e=x.list)[e.length-1];return n>=i&&n<=a&&r>=i&&r<=a});r.map(function(t){var e;e=t["中文片名"];if(!i[e]||+i[e]["累計銷售金額"]<+t["累計銷售金額"]){return i[e]=t}});for(l in i){u=i[l];i[l]=JSON.parse(JSON.stringify(u))}r.map(function(t){var e;e=t["中文片名"];if(i[e]&&+i[e]["上映院數"]<+t["上映院數"]){return i[e]["上映院數"]=+t["上映院數"]}});this.movie.all=function(){var t,e=[];for(l in t=i){u=t[l];e.push(u)}return e}();this.movie.tw=this.movie.all.filter(function(t){return in$("中華民國",t["國別地區"])});if(e){d=[["revenue","國片累計銷售金額分布","累計銷售金額","tw"],["ticket","國片累計銷售票數分布","累計銷售票數","tw"],["theatre","國片上映院數分布","上映院數","tw"],["revenue","電影累計銷售金額分布","累計銷售金額","all"],["ticket","電影累計銷售票數分布","累計銷售票數","all"],["theatre","電影上映院數分布","上映院數","all"]];for(c=0,h=d.length;c<h;++c){f=d[c];if(!((p=e[f[1]])&&p.name)){continue}p=p.name.value.map(k);this.movie[f[3]]=this.movie[f[3]].filter(y)}if(e["出品人比例"]){v=e["出品人比例"].name||{type:"exclude",value:[]};if(v.type!=="exclude"){console.error("expected filter type for 出品人比例 should be `exclude`")}v=v.value||[];this.movie.tw=this.movie.tw.filter(function(t){return t["出品"].filter(function(t){return!in$(t,v)}).length})}}this.movie.all.map(function(r){return(r["國別地區"]||[]).map(function(t,e){var n;((n=b.movie.byCountry)[t]||(n[t]=[])).push(r);return b.movie.continentmap[t]=r["洲別"][e]})});this.bins={tw:{},all:{}};this.binned={tw:{},all:{}};m={revenue:[0,1e3,5e3,1e4,1e5,1e6,1e7,1e8,1e9,1e11],ticket:[0,100,500,1e3,5e3,1e4,5e4,1e5,5e5,1e6],theatre:[0,5,10,15,20,30,50,70,90]};this.binThresholds={tw:m,all:m};this.bins.all.revenue=d3.bin().thresholds(this.binThresholds.all.revenue);this.bins.all.ticket=d3.bin().thresholds(this.binThresholds.all.ticket);this.bins.all.theatre=d3.bin().thresholds(this.binThresholds.all.theatre);this.bins.tw.revenue=d3.bin().thresholds(this.binThresholds.tw.revenue);this.bins.tw.ticket=d3.bin().thresholds(this.binThresholds.tw.ticket);this.bins.tw.theatre=d3.bin().thresholds(this.binThresholds.tw.theatre);this.binned.all.revenue=this.bins.all.revenue(this.movie.all.map(function(t){return t["累計銷售金額"]}));this.binned.all.ticket=this.bins.all.ticket(this.movie.all.map(function(t){return t["累計銷售票數"]}));this.binned.all.theatre=this.bins.all.theatre(this.movie.all.map(function(t){return t["上映院數"]}));this.binned.tw.revenue=this.bins.tw.revenue(this.movie.tw.map(function(t){return t["累計銷售金額"]}));this.binned.tw.ticket=this.bins.tw.ticket(this.movie.tw.map(function(t){return t["累計銷售票數"]}));this.binned.tw.theatre=this.bins.tw.theatre(this.movie.tw.map(function(t){return t["上映院數"]}));this.movie.all.sort(function(t,e){return e["累計銷售金額"]-t["累計銷售金額"]});this.movie.all.map(function(t,e){return t.rank=e+1});this.total={all:{revenue:this.movie.all.reduce(function(t,e){return t+e["累計銷售金額"]},0),ticket:this.movie.all.reduce(function(t,e){return t+e["累計銷售票數"]},0)},tw:{revenue:this.movie.tw.reduce(function(t,e){return t+e["累計銷售金額"]},0),ticket:this.movie.tw.reduce(function(t,e){return t+e["累計銷售票數"]},0)}};g=n.slice(5);g=g.filter(function(t){return!(t==="銷售票數"||t==="銷售金額")});w={tw:{},all:{}};["all","tw"].map(function(e){return b.movie[e].map(function(t){return w[e][t["中文片名"]]=true})});this.movie.all.map(function(){return w.all});this.date={revenue:{}};r.map(function(t){var e,n,r;e=t["迄計日"];n=t["銷售金額"];r=b.date.revenue[e]||(b.date.revenue[e]={});r.date=e;if(w.all[t["中文片名"]]){r.all=(r.all||0)+n}if(w.tw[t["中文片名"]]){if(t["來源"]==="國內"){r.tw=(r.tw||0)+n}}if(t["來源"]!=="國內"){return r.other=(r.other||0)+n}});return T(function(){var t=[];for(l in this.date.revenue){t.push(l)}return t}.call(this)).map(function(t){if(b.date.revenue[t]){return}return b.date.revenue[t]={date:t,all:0,tw:0,other:0}});function k(t){var e,n,r,i,a;e=b.binThresholds[f[3]][f[0]];if(!~(n=e.indexOf(+t))){for(r=0,i=e.length;r<i;++r){a=r;if(e[a]<+t){continue}n=a;break}if(!~n){n=e.length}}return[e[n-1],+t]}function y(t){var e;e=t[f[2]];return p.filter(function(t){return e>=t[0]&&e<=t[1]}).length}}},getData:function(){var d=this;return ld$.fetch("/assets/data/tfi/all.json",{method:"GET"},{type:"json"}).then(function(t){var e,n,r,i,a,s,o,l,u=[];e=t.head;n=t.body.map(function(n){return Object.fromEntries(e.map(function(t,e){return[t,n[e]]}))});d.raw={name:"電影票房資訊",head:e,body:n};n.map(function(t){t["起計日"]=t["src-year"]+"/"+t["src-date"].substring(0,2)+"/"+t["src-date"].substring(2);t["迄計日"]=t["des-year"]+"/"+t["des-date"].substring(0,2)+"/"+t["des-date"].substring(2);t["來源"]=in$("中華民國",t["國別地區"])?"國內":"國外";t["中文片名"]=t["中文片名"].replace(/ /g,"");return t["申請人"]=t["申請人"].replace(/ /g,"")});d.dates.list=Array.from(new Set(n.map(function(t){return t["迄計日"]})));d.dates.list=T(d.dates.list);d.dates.picked.end=(r=d.dates.list)[r.length-1];i=new Date(d.dates.picked.end).getTime()-864e5*182;d.dates.picked.start=d.dates.list.filter(function(t){return new Date(t).getTime()>=i})[0]||(r=d.dates.list)[r.length-1];d.data={all:{},part:{}};d.parse.tw.call(d.data.all,d.raw);d.parse.tw.call(d.data.part,d.raw);a=["國別地區","中文片名","上映日期","上映院數","累計銷售票數","累計銷售金額","申請人","出品"];d.sheetHead=s=a.map(function(t,e){var n;n=document.createElement("div");n.classList.add("w-100","h-100","d-flex","justify-content-between","align-items-center");n.innerHTML="<div>"+t+'</div><div class="text-sm mx-1"><i class="" data-idx="'+e+'"></div>';return{type:"dom",node:n}});d.sheetSort=a.map(function(){return-1});d.sheetData=[s].concat(d.data.all.movie.all.map(function(e){return a.map(function(t){if(Array.isArray(e[t])){return e[t].join("\n")}else{return e[t]}})}));d.sheet=new sheet({root:d.view.get("detail"),data:d.sheetData,frozen:{row:1},size:{col:["6em","15em","7em","6em","8em","8em","24em"]},editing:false});for(o in r=d.chart){l=r[o];u.push(d.chart[o].info=l.call(d.data.part,d.data))}return u})}});return this.init().then(function(){e.inited=true;return e.view.render("loader")}).then(function(){return console.log("[perf] startup elapsed time: "+((Date.now()-t.t1)/1e3).toFixed(2)+"s")})});function import$(t,e){var n={}.hasOwnProperty;for(var r in e)if(n.call(e,r))t[r]=e[r];return t}function in$(t,e){var n=-1,r=e.length>>>0;while(++n<r)if(t===e[n])return true;return false}(function(e){return e.apply(dashboard)})(function(){this.layout.tw={grid:{col:["1fr","1fr","1fr","2fr","1fr","2fr"],row:["2fr","2fr","2fr","2fr"]},panels:[{row:[1,1],col:[1,1],name:"國片總上映數",class:["highlight","color","color-film"]},{row:[1,1],col:[2,1],name:"國片票房總金額",class:["highlight","color","color-revenue"]},{row:[1,1],col:[3,1],name:"國片總售票數",class:["highlight","color","color-ticket"]},{row:[1,1],col:[4,2],name:"國片當週銷售走勢"},{row:[2,1],col:[5,2],name:"國片與外片逐週銷售比例"},{row:[3,2],col:[5,2],name:"出品人比例"},{row:[2,3],col:[3,2],name:"國片銷售排行與票房佔比"},{row:[2,1],col:[1,2],name:"國片累計銷售金額分布"},{row:[3,1],col:[1,2],name:"國片累計銷售票數分布"},{row:[4,1],col:[1,2],name:"國片上映院數分布"}]};this.layout.tw.panels.map(function(e,n){return e.idx=n,e.layout="tw",e});this.chart["電影銷售總排行與票房佔比"]=function(){var e,n;e={raw:this.movie.all,binding:{name:{key:"中文片名"},value:{key:"累計銷售金額"}}};n={line:"#fff",collapse:{enabled:true,method:"count",threshold:15}};return{bind:e,cfg:n,type:"percent-list",dash:"tw"}};this.chart["國片銷售排行與票房佔比"]=function(){var e,n;e={raw:this.movie.tw,binding:{name:{key:"中文片名"},value:{key:"累計銷售金額"}}};n={line:"#fff",collapse:{enabled:true,method:"count",threshold:15}};return{bind:e,cfg:n,type:"percent-list",dash:"tw"}};this.chart["出品人比例"]=function(e,n){var t,a,r,i,l;n==null&&(n={});t={};this.movie.tw.map(function(e){return(e["出品"]||[]).map(function(e){return t[e]=(t[e]||0)+1})});a={raw:function(){var e,n=[];for(r in e=t){i=e[r];n.push({"出品人":r,"數量":i})}return n}(),binding:{name:{key:"出品人"},size:{key:"數量",unit:"部"}}};l={};return{bind:a,cfg:l,type:"bar-list",dash:"tw"}};this.chart["申請人比例"]=function(){var t,e,a,r,n;t={};this.movie.all.map(function(e){var n;n=e["申請人"];if(n){return t[n]=(t[n]||0)+1}});e={raw:function(){var e,n=[];for(a in e=t){r=e[a];n.push({name:a,value:r})}return n}(),binding:{name:{key:"name"},value:{key:"value"}}};n={collapse:{enabled:true,method:"count",threshold:6}};return{bind:e,cfg:n,type:"pie",dash:"tw"}};this.chart["電影來源國家"]=function(){var e,t,a,n;e={raw:function(){var e,n=[];for(t in e=this.movie.byCountry){a=e[t];n.push({name:t,value:a.length})}return n}.call(this),binding:{value:{key:"value"},name:{key:"name"}}};n={collapse:{enabled:true,threshold:5,method:"count"}};return{cfg:n,bind:e,type:"pie",dash:"tw"}};this.chart["國片銷售佔比樹狀圖"]=function(){var e,n;e={};n={raw:this.movie.tw,binding:{name:{key:"中文片名"},area:{key:"累計銷售金額",name:"票房"}}};return{bind:n,cfg:e,type:"treemap",dash:"tw"}};this.chart["國片總上映數"]=function(){var e;e={raw:[{value:this.movie.tw.length,number:"國片總上映數"}],binding:{value:{key:"value",unit:"部"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"tw"}};this.chart["國片票房總金額"]=function(){var e;e={raw:[{value:Math.round(this.total.tw.revenue/1e6),number:"累計銷售金額"}],binding:{value:{key:"value",unit:"百萬新臺幣"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"tw"}};this.chart["國片總售票數"]=function(){var e;e={raw:[{value:Math.round(this.total.tw.ticket/1e6),number:"總銷售票數"}],binding:{value:{key:"value",unit:"百萬張"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"tw"}};this.chart["國片累計銷售金額分布"]=function(t,e){var n,a,r,i;e==null&&(e={});n=t.all.binned.tw.revenue.map(function(n){var e;e=t.part.binned.tw.revenue.filter(function(e){return e.x0>=n.x0&&e.x0<n.x1})[0]||[];return{excluded:n.length-e.length,picked:e.length,name:n.x1+""}});a={raw:n,binding:{size:[{key:"picked",name:"銷售金額"},{key:"excluded",name:"銷售金額"}],name:{key:"name",filter:e.name}}};r=pal.colors[0];i={tickFormat:".0~s",tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(r,5),r]}};return{bind:a,cfg:i,type:"bar",dash:"tw"}};this.chart["國片累計銷售票數分布"]=function(t){var e,n,a,r;e=t.all.binned.tw.ticket.map(function(n){var e;e=t.part.binned.tw.ticket.filter(function(e){return e.x0>=n.x0&&e.x0<n.x1})[0]||[];return{excluded:n.length-e.length,picked:e.length,name:n.x1+"",start:n.x1,end:n.x2}});n={raw:e,binding:{size:[{key:"picked",name:"銷售票數"},{key:"excluded",name:"銷售票數"}],name:{key:"name"}}};a=pal.colors[1];r={tickFormat:".0~s",toggleLegend:false,tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(a,5),a]}};return{bind:n,cfg:r,type:"bar",dash:"tw"}};this.chart["國片上映院數分布"]=function(t){var e,n,a,r;e=t.all.binned.tw.theatre.map(function(n){var e;e=t.part.binned.tw.theatre.filter(function(e){return e.x0>=n.x0&&e.x0<n.x1})[0]||[];return{excluded:n.length-e.length,picked:e.length,name:n.x1+""}});n={raw:e,binding:{size:[{key:"picked",name:"上映院數"},{key:"excluded",name:"上映院數"}],name:{key:"name"}}};a=pal.colors[2];r={tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(a,5),a]}};return{bind:n,cfg:r,type:"bar",dash:"tw"}};this.chart["國片當週銷售走勢"]=function(){var e,n,t,a,r,i,l;n=[];for(t in a=this.date.revenue){r=a[t];n.push(r)}e=n;e.sort(function(e,n){if(e.date>n.date){return 1}else if(e.date<n.date){return-1}else{return 0}});e.map(function(e){var n;n=e.date.split("/");return e.dateText=n[0]+"\n"+n[1]+"/"+n[2]});i={raw:e,binding:{value:[{key:"tw",name:"票房",unit:"元"}],order:{key:"dateText",name:"日期"}}};l={dotSize:1.5,legend:{enabled:false},xaxis:{enabled:true,showCaption:false},yaxis:{enabled:true,boundaryTickOffset:false,format:d3.format(".2s")}};return{bind:i,cfg:l,type:"line",dash:"tw"}};return this.chart["國片與外片逐週銷售比例"]=function(){var e,n,t,a,r,i,l;n=[];for(t in a=this.date.revenue){r=a[t];n.push(r)}e=n;e.sort(function(e,n){if(e.date>n.date){return 1}else if(e.date<n.date){return-1}else{return 0}});e.map(function(e,n){var t;e.idx=n;t=e.date.split("/");return e.dateText=t[0]+"\n"+t[1]+"/"+t[2]});i={raw:e,binding:{size:[{key:"tw",name:"國內"},{key:"other",name:"國外"}],name:{key:"dateText",name:"日期"}}};l={percent:true,xaxis:{enabled:true,showCaption:false},yaxis:{enabled:false},brush:{enabled:false},pal:{colors:[pal.colors[0],ldcolor.web(ldcolor.complement(pal.colors[0]))]}};return{bind:i,cfg:l,type:"bar",dash:"tw"}}});(function(e){return e.apply(dashboard)})(function(){this.layout.all={grid:{col:["1fr","1fr","1fr","2fr","1fr","2fr"],row:["2fr","1fr","1fr","1fr","1fr","1fr","1fr"]},panels:[{row:[1,1],col:[1,1],name:"電影總上映數",class:["highlight","color","color-film"]},{row:[1,1],col:[2,1],name:"電影票房總金額",class:["highlight","color","color-revenue"]},{row:[1,1],col:[3,1],name:"電影總售票數",class:["highlight","color","color-ticket"]},{row:[1,1],col:[4,2],name:"電影當週銷售走勢"},{row:[2,2],col:[1,2],name:"電影累計銷售金額分布"},{row:[4,2],col:[1,2],name:"電影累計銷售票數分布"},{row:[6,2],col:[1,2],name:"電影上映院數分布"},{row:[2,6],col:[3,2],name:"上映電影之來源國家比較"},{row:[2,3],col:[5,2],name:"上映之各國電影數量"},{row:[5,3],col:[5,2],name:"各國銷售金額合計"}]};this.layout.all.panels.map(function(e,n){return e.idx=n,e.layout="all",e});this.chart["電影總上映數"]=function(){var e;e={raw:[{value:this.movie.all.length,number:"電影總上映數"}],binding:{value:{key:"value",unit:"部"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"all"}};this.chart["電影票房總金額"]=function(){var e;e={raw:[{value:Math.round(this.total.all.revenue/1e6),number:"累計銷售金額"}],binding:{value:{key:"value",unit:"百萬新臺幣"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"all"}};this.chart["電影總售票數"]=function(){var e;e={raw:[{value:Math.round(this.total.all.ticket/1e6),number:"總銷售票數"}],binding:{value:{key:"value",unit:"百萬張"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"all"}};this.chart["電影當週銷售走勢"]=function(){var e,n,a,r,t,l,i;n=[];for(a in r=this.date.revenue){t=r[a];n.push(t)}e=n;e.sort(function(e,n){if(e.date>n.date){return 1}else if(e.date<n.date){return-1}else{return 0}});e.map(function(e){var n;n=e.date.split("/");return e.dateText=n[0]+"\n"+n[1]+"/"+n[2]});l={raw:e,binding:{value:[{key:"all",name:"票房",unit:"元"}],order:{key:"dateText",name:"日期"}}};i={dotSize:1.5,legend:{enabled:false},xaxis:{enabled:true,showCaption:false},yaxis:{enabled:true,boundaryTickOffset:false,format:d3.format(".2s")}};return{bind:l,cfg:i,type:"line",dash:"all"}};this.chart["電影累計銷售金額分布"]=function(a){var e,n,r,t;e=a.all.binned.all.revenue.map(function(n){var e;e=a.part.binned.all.revenue.filter(function(e){return e.x0>=n.x0&&e.x0<n.x1})[0]||[];return{excluded:n.length-e.length,picked:e.length,name:n.x1+""}});n={raw:e,binding:{size:[{key:"picked",name:"銷售金額"},{key:"excluded",name:"銷售金額"}],name:{key:"name"}}};r=pal.colors[0];t={tickFormat:".0~s",tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(r,5),r]}};return{bind:n,cfg:t,type:"bar",dash:"all"}};this.chart["電影累計銷售票數分布"]=function(a){var e,n,r,t;e=a.all.binned.all.ticket.map(function(n){var e;e=a.part.binned.all.ticket.filter(function(e){return e.x0>=n.x0&&e.x0<n.x1})[0]||[];return{excluded:n.length-e.length,picked:e.length,name:n.x1+""}});n={raw:e,binding:{size:[{key:"picked",name:"銷售票數"},{key:"excluded",name:"銷售票數"}],name:{key:"name"}}};r=pal.colors[1];t={tickFormat:".0~s",toggleLegend:false,tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(r,5),r]}};return{bind:n,cfg:t,type:"bar",dash:"all"}};this.chart["電影上映院數分布"]=function(a){var e,n,r,t;e=a.all.binned.all.theatre.map(function(n){var e;e=a.part.binned.all.theatre.filter(function(e){return e.x0>=n.x0&&e.x0<n.x1})[0]||[];return{excluded:n.length-e.length,picked:e.length,name:n.x1+""}});n={raw:e,binding:{size:[{key:"picked",name:"上映院數"},{key:"excluded",name:"上映院數"}],name:{key:"name"}}};r=pal.colors[2];t={tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(r,5),r]}};return{bind:n,cfg:t,type:"bar",dash:"all"}};this.chart["上映之各國電影數量"]=function(e){var n,a,r,t;n={raw:function(){var e,n=[];for(a in e=this.movie.byCountry){r=e[a];n.push({name:a,value:r.length})}return n}.call(this),binding:{color:{key:"value",unit:"部"},name:{key:"name"}}};t={pal:{colors:["#444","#e8c05c","#6ee97d","#577aeb"]},legendFormat:".0~s",dimEmpty:true};return{bind:n,cfg:t,type:"worldmap",dash:"all"}};this.chart["上映電影之來源國家比較"]=function(e){var n,a,r,t;n={raw:function(){var e,n=[];for(a in e=this.movie.byCountry){r=e[a];n.push({name:a,value:r.length})}return n}.call(this),binding:{name:{key:"name"},area:{key:"value",unit:"部"},color:{key:"name"}}};t={};return{bind:n,cfg:t,type:"bubble",dash:"all"}};return this.chart["各國銷售金額合計"]=function(e){var n,r,t,a;n={raw:function(){var e,n=[];for(r in e=this.movie.byCountry){t=e[r];n.push({name:r,value:t.reduce(a,0),category:this.movie.continentmap[r]})}return n;function a(e,n){return e+n["累計銷售金額"]/1e6}}.call(this),binding:{name:{key:"name"},area:{key:"value",unit:"百萬新臺幣"},category:{key:"category"}}};a={legend:{enabled:true,selectable:false}};return{bind:n,cfg:a,type:"treemap",dash:"all"}}});</script></body></html>