<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html;charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1"><!-- Global site tag (gtag.js) - Google Analytics--><script async src="https://www.googletagmanager.com/gtag/js?id=G-HXVX4JRNGZ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HXVX4JRNGZ');</script><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap/main/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><base href="/"><style type="text/css">body{font-size:24px}.flex-gap{gap:.25em}.cell{padding:.5em;border-radius:.2em;color:#fff;background:#19232e}.code pre{white-space:pre-wrap;width:100%}.text-right{text-align:right}.noir{font-size:2em;font-weight:bold;font-family:monospace;width:1em;display:inline-block;text-align:center;line-height:1em;margin-bottom:.2em}</style></head><body><div class="w-1024 rwd mx-auto my-4 typeset heading-contrast"><h1>資料檔格式簡介</h1><div class="text-muted text-sm">用於文化內容策進院之「文創產調視覺化」之資料檔說明文件</div><div class="py-4"><hr></div><div class="sect"><p>此文件說明如何建立、編輯使用於文創產調視覺化之資料檔案。首先，您可能會最關心的應該就是「檔案格式」跟「編輯軟體」了：</p><div class="font-weigh-bold mt-4 mb-2"><b>※ 檔案格式</b></div><div class="d-flex align-items-center flex-gap"><div style="padding-right:1em"><img src="/assets/img/spec/csv.png" style="max-width:480px;width:90%"></div><div class="flex-grow-1"><p>文化內容策進院之「文創產調視覺化」( 後稱產調視覺化 ) 為一線上網站，使用 JavaScript 即時載入並繪製資料檔成互動圖表。</p><p>為了方便直接透過線上程式讀取，資料檔格式以 <b>CSV ( 逗號分格數值 )</b> 格式為主，可以透過試算表軟體 ( 如 Google Spreadsheet 與 Microsoft Excel ) 中編輯後匯出。此份文件將<b>著重在試算表中資料的編排方式</b>，不會涉及到檔案格式等較低階的細節。</p></div></div><div class="font-weigh-bold mt-4 mb-2"><b>※ 編輯軟體</b></div><div class="d-flex align-items-center flex-gap"><div class="flex-grow-1"><p>要編輯此類檔案，您僅需要準備 Microsoft Excel 或 Google Spreadsheet 等軟體；若牽涉到軟體使用的部份，<b>此文件將以 Google Spreadsheet 做為示範工具</b>，但兩者的概念大多通用，若您希望使用 Microsoft Excel 或其它相似的軟體，您可將文件說明的部份類推至您的軟體上使用。</p></div><div style="padding-left:1em"><img src="/assets/img/spec/google-sheet.png"></div></div><br><p>此文件分為以下章節：</p><ul><li>簡介</li><li>試算表結構規範</li><li>多重資料表</li><li>屬性規劃方針</li><li>NOIR 資料分類法</li></ul></div><div class="sect"><h2>簡介</h2><p>為了讓程式能夠順利讀取您的資料，您的資料必須要「<b>結構化</b>」。結構化不容易簡單說明，但大致上，資料必須要有一致性，避免混雜排版、自然語言等資訊，並且盡量將複合性的資訊分開記載。</p><div class="font-weigh-bold mt-4 mb-2"><b>※ 基本架構</b></div><p>為方便接下來的說明，我們簡單描繪一下表格的長相。如下圖：</p><ul><li>資料以表格呈現</li><li><b>由上而下為逐筆資料 ( data row )</b></li><li><b>由左至右則為各筆資料的不同欄位 ( data column / field )</b></li></ul><div class="row"><div class="col-md"><div class="text-sm text-muted">各筆資料</div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="cell bg-danger">第一筆資料</div><div class="cell bg-danger"> </div><div class="cell bg-danger"> </div><div class="cell bg-warning text-dark">第二筆資料</div><div class="cell bg-warning"></div><div class="cell bg-warning"></div><div class="cell bg-success">第三筆資料</div><div class="cell bg-success"></div><div class="cell bg-success"></div></div></div><div class="col-md"><div class="text-sm text-muted">各個欄位</div><div class="text-center" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="cell bg-danger">第一欄</div><div class="cell bg-warning text-dark"> 第二欄</div><div class="cell bg-success">第三欄</div><div class="cell bg-danger">&nbsp;</div><div class="cell bg-warning"></div><div class="cell bg-success"></div><div class="cell bg-danger">&nbsp;</div><div class="cell bg-warning"></div><div class="cell bg-success"></div></div></div></div><div class="font-weigh-bold mt-4 mb-2"><b>※ 資料一致性</b></div><p>以下例來說，左表在數字中混雜了文字、縮寫跟單位，缺乏一致性；中表在數字中使用文字加註說明；右表在同一個欄位中記載兩組資料：</p><div class="row"><div class="col-md"><div class="text-sm text-muted">缺乏一致性</div><div class="d-flex flex-column flex-gap"><div class="bg-dark text-white p-2 rounded">5k</div><div class="bg-dark text-white p-2 rounded">256</div><div class="bg-dark text-white p-2 rounded">五千元</div></div></div><div class="col-md"><div class="text-sm text-muted">缺乏一致性</div><div class="d-flex flex-column flex-gap"><div class="bg-dark text-white p-2 rounded">102年</div><div class="bg-dark text-white p-2 rounded">103年</div><div class="bg-dark text-white p-2 rounded">104年 (僅 A 類)</div></div></div><div class="col-md"><div class="text-sm text-muted">混合資料程式不能用</div><div class="d-flex flex-column flex-gap"><div class="bg-dark text-white p-2 rounded">203 / 五折</div><div class="bg-dark text-white p-2 rounded">198 / 七折</div><div class="bg-dark text-white p-2 rounded">200 / 六折</div></div></div></div><p>改進的方式並不難，首先統一格式，接著抽離單位，最後將混合欄位分開：</p><div class="row"><div class="col-md"><div class="d-flex flex-column flex-gap"><div class="bg-secondary text-white p-2 rounded">元</div><div class="bg-dark text-white p-2 rounded">5000</div><div class="bg-dark text-white p-2 rounded">256</div><div class="bg-dark text-white p-2 rounded">5000</div></div></div><div class="col-md"><div class="d-flex flex-column flex-gap"><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-secondary text-white p-2 rounded">年</div><div class="flex-grow-1 bg-secondary text-white p-2 rounded">分類</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">102</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">全部</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">103</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">全部</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">104</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">A</div></div></div></div><div class="col-md"><div class="d-flex flex-column flex-gap"><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-secondary text-white p-2 rounded">元</div><div class="flex-grow-1 bg-secondary text-white p-2 rounded">折數</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">203</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">5</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">198</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">7</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">200</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">6</div></div></div></div></div><p>由於大多數的資料都有單位的概念，因此上表此類「<b>標頭 ( header ) + 資料 ( body )</b> 」的基本格式可說是我們表格的最基本格式。</p><p>又或者，下表某真實案例中，記載各類型廣播電臺的涵蓋電臺，等於將多組資料寫在單一儲存格中，並用頓號排板，前後文結構又不一致，程式無法正確分析：</p><div class="d-flex flex-column flex-gap mb-4"><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-secondary text-white p-2 rounded">類型</div><div class="flex-grow-1 bg-secondary text-white p-2 rounded">涵蓋電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">公營電臺 (10) </div><div class="flex-grow-1 bg-dark text-white p-2 rounded">內政部警政署警察廣播電臺（大功率）、國立教育廣播電臺（大功率）、漢聲廣播電臺（國防部心理作戰大隊）（大功率）、復興廣播電臺（大功率）、行政院農業委員會漁業署漁業廣播電臺（大功率）、臺北廣播電臺（大功率）、高雄廣播電臺（大功率）、財團法人中央廣播電臺（海外短波）、講客廣播電臺（客家委員會）（大功率）、財團法人原住民族文化事業基金會（大功率）</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:3em 1fr"><div class="bg-dark text-white p-2 rounded">調幅電臺（16）</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">中華、天南、天聲、民本、民立、先聲、成功、建國、電聲、益世、國聲、基隆、勝利之聲、華聲、鳳鳴、燕聲</div></div></div><p>以上例來說，我們可以做以下改進：</p><ul><li>數字並不需要，程式即可做統計</li><li>各電臺分別陳列在不同筆資料之中</li></ul><p>調整後的資料表如下：</p><div class="d-flex flex-column flex-gap mb-4"><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="flex-grow-1 bg-secondary text-white p-2 rounded">電臺</div><div class="bg-secondary text-white p-2 rounded">類型</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">內政部警政署警察廣播電臺（大功率）</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">公營電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">國立教育廣播電臺（大功率）</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">公營電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">漢聲廣播電臺（國防部心理作戰大隊）（大功率）</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">公營電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">中華</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">調幅電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">天南</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">調幅電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">天聲</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">調幅電臺</div></div><div class="w-100" style="display:grid;gap:.25em;grid-template-columns:1fr 6em"><div class="bg-dark text-white p-2 rounded">民本</div><div class="flex-grow-1 bg-dark text-white p-2 rounded">調幅電臺</div></div><div class="cell">... 下略 ...</div></div><div class="font-weigh-bold mt-4 mb-2"><b>※ 嚴禁合併儲存格</b></div><p>為了將各筆資料明確分割，嚴禁使用合併儲存格。的確，由於統計上的困難，有時無法準確的將資料切分開來，然而這樣的資料就算您做成了資料檔，程式也是無法呈現。</p><p>為了盡量呈現您手中的資料，您可以選擇：</p><ul><li>標註為「無資料」 ( 留空白, 或使用橫線 「<b>-</b>」 )</li><li>將表格依欄位分割後，再合併的資料組重新編排</li></ul><div class="row mb-4"><div class="col-md"><div class="text-sm text-muted">請不要這樣做</div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="bg-danger text-white p-2 rounded">年度</div><div class="bg-danger text-white p-2 rounded">金額</div><div class="bg-danger text-white p-2 rounded">數量</div><div class="bg-dark text-white p-2 rounded">2018</div><div class="bg-dark text-white p-2 rounded" style="grid-area: 2 / 2 / span 2 / 2">500</div><div class="bg-dark text-white p-2 rounded">25</div><div class="bg-dark text-white p-2 rounded">2019</div><div class="bg-dark text-white p-2 rounded" style="grid-area: 3 / 3 / span 2 / 3">16</div><div class="bg-dark text-white p-2 rounded">2020</div><div class="bg-dark text-white p-2 rounded">250</div></div></div><div class="col-md"><div class="text-sm text-muted">寧可省略</div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="bg-success text-white p-2 rounded">年度</div><div class="bg-success text-white p-2 rounded">金額</div><div class="bg-success text-white p-2 rounded">數量</div><div class="bg-dark text-white p-2 rounded">2018</div><div class="bg-dark text-white p-2 rounded">-</div><div class="bg-dark text-white p-2 rounded">25</div><div class="bg-dark text-white p-2 rounded">2019</div><div class="bg-dark text-white p-2 rounded">-</div><div class="bg-dark text-white p-2 rounded">-</div><div class="bg-dark text-white p-2 rounded">2020</div><div class="bg-dark text-white p-2 rounded">250</div><div class="bg-dark text-white p-2 rounded">-</div></div></div></div><div class="row mb-4"><div class="col-md"><div class="text-sm text-muted">切割表格後留下金額</div><div style="display:grid;grid-template-columns:1fr 1fr;gap:.25em"><div class="bg-success text-white p-2 rounded">年度</div><div class="bg-success text-white p-2 rounded">金額</div><div class="bg-dark text-white p-2 rounded">2018 ~ 2019</div><div class="bg-dark text-white p-2 rounded">500</div><div class="bg-dark text-white p-2 rounded">2000</div><div class="bg-dark text-white p-2 rounded">250</div></div></div><div class="col-md"><div class="text-sm text-muted">切割表格後留下數量</div><div style="display:grid;grid-template-columns:1fr 1fr;gap:.25em"><div class="bg-success text-white p-2 rounded">年度</div><div class="bg-success text-white p-2 rounded">數量</div><div class="bg-dark text-white p-2 rounded">2018 </div><div class="bg-dark text-white p-2 rounded">25</div><div class="bg-dark text-white p-2 rounded">2019 ~ 2000</div><div class="bg-dark text-white p-2 rounded">16</div></div></div></div><div class="row"><div class="col-md"><div class="text-sm text-muted">進一步結構化</div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="bg-primary text-white p-2 rounded">起始年度</div><div class="bg-primary text-white p-2 rounded">結束年度</div><div class="bg-primary text-white p-2 rounded">金額</div><div class="bg-dark text-white p-2 rounded">2018</div><div class="bg-dark text-white p-2 rounded">2019</div><div class="bg-dark text-white p-2 rounded">500</div><div class="bg-dark text-white p-2 rounded">2000</div><div class="bg-dark text-white p-2 rounded">2000</div><div class="bg-dark text-white p-2 rounded">250</div></div></div><div class="col-md"><div class="text-sm text-muted">&nbsp;</div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="bg-primary text-white p-2 rounded">起始年度</div><div class="bg-primary text-white p-2 rounded">結束年度</div><div class="bg-primary text-white p-2 rounded">數量</div><div class="bg-dark text-white p-2 rounded">2018 </div><div class="bg-dark text-white p-2 rounded">2018</div><div class="bg-dark text-white p-2 rounded">25</div><div class="bg-dark text-white p-2 rounded">2019</div><div class="bg-dark text-white p-2 rounded">2000</div><div class="bg-dark text-white p-2 rounded">16</div></div></div></div><div class="font-weigh-bold mt-4 mb-2"><b>※ 摘要</b></div><p>依上述的結構化要求，一個最基本的資料表格如下：</p><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:.25em"><div class="cell bg-secondary">欄位1</div><div class="cell bg-secondary">欄位2</div><div class="cell bg-secondary">欄位3</div><div class="cell bg-secondary">欄位4</div><div class="cell bg-dark">第一筆資料 <div class="text-sm text-muted">欄位1的值</div></div><div class="cell bg-dark">第一筆資料 <div class="text-sm text-muted">欄位2的值</div></div><div class="cell bg-dark">第一筆資料 <div class="text-sm text-muted">欄位3的值</div></div><div class="cell bg-dark">第一筆資料 <div class="text-sm text-muted">欄位4的值</div></div><div class="cell bg-dark">第二筆資料 <div class="text-sm text-muted">欄位1的值</div></div><div class="cell bg-dark">第二筆資料 <div class="text-sm text-muted">欄位2的值</div></div><div class="cell bg-dark">第二筆資料 <div class="text-sm text-muted">欄位3的值</div></div><div class="cell bg-dark">第二筆資料 <div class="text-sm text-muted">欄位4的值</div></div><div class="cell bg-dark" style="grid-area:4 / 1 / 4 / 5"><div class="text-sm text-muted">... ( 後續其它筆資料 )</div></div><div class="cell bg-dark" style="grid-area:5 / 1 / 5 / 5"><div class="text-sm text-muted">... ( 後續其它筆資料 )</div></div></div><p>最後，請確保<b>單一檔案僅包含一個表格</b>。如果您有多組表格，只要無法合理併成一個表格，就應該另外存成獨立的檔案，避免程式無法正確解析。</p></div><div class="sect"><h2>試算表結構規範</h2><p>除了一般結構化的概念，我們還必須要考慮到程式的特定用途，在此處即為「產調視覺化」線上圖表繪製的用途。為了生成圖表，我們需要以下資訊：</p><ul><li><b>說明性資料</b> — 資料集標題、註解等</li><li><b>欄位資訊</b> — 各欄位名稱、型態、單位等</li><li><b>資料內容</b> — 實際數字、文字等本身</li><li><b>保留欄位</b> — 格式版本等程式未來可能會需要的擴充機制</li></ul><p>一般來說，這些資訊通常會使用程式常見的專用格式來儲存 ( 如 JSON 或 XML )，但由於此類文件通常較不容易讓一般人編輯，但一般較容易編輯的 Microsoft Excel 檔案卻又過於一般性，沒有這些資訊的規範，因此我們必須明確規定如何在試算表檔案中加入這些資訊，並請編輯人員遵照規定編輯試算表檔案。</p></div><p>首先，在一個普通的試算表中，我們在上面保留 7 行用以記載額外的資訊；第 8 行以後則為單純的資料區域。前 7 行資料又分為「表格」與「欄位」的中介資訊：</p><ul><li><b>表格中介資訊</b>：說明這個表格，包括標題、註解、程式用保留資料等，共 3 行。</li><li><b>欄位中介資料</b>：說明表格中各個欄位的單位，意含跟資料類型等，共 4 行。</li></ul><p>以圖像化的方式來呈現：</p><div class="mb-4" style="display:grid;grid-template-columns:2em 1fr;gap:.25em"><div class="bg-light text-secondary rounded p-2 text-center">1</div><div class="bg-info text-white rounded p-2">標題</div><div class="bg-light text-secondary rounded p-2 text-center">2</div><div class="bg-info text-white rounded p-2">保留列 ( 請留白 )</div><div class="bg-light text-secondary rounded p-2 text-center">3</div><div class="bg-info text-white rounded p-2">註解</div><div class="bg-light text-secondary rounded p-2 text-center">4</div><div class="bg-secondary text-white rounded p-2">資料類型 ( 文字、數值等，以 NOIR 分類法表示，於後續章節說明 )</div><div class="bg-light text-secondary rounded p-2 text-center">5</div><div class="bg-secondary text-white rounded p-2">單位 ( 例如：元、人、頁 )</div><div class="bg-light text-secondary rounded p-2 text-center">6</div><div class="bg-secondary text-white rounded p-2">保留列 ( 請留白 )</div><div class="bg-light text-secondary rounded p-2 text-center">7</div><div class="bg-secondary text-white rounded p-2">欄位名 ( 如年份、出口值、人次、頁數等 )</div><div class="bg-light text-secondary rounded p-2 text-center">8</div><div class="bg-dark text-light rounded p-2">資料1</div><div class="bg-light text-secondary rounded p-2 text-center">9</div><div class="bg-dark text-light rounded p-2">資料2</div><div class="bg-light text-secondary rounded p-2 text-center">10</div><div class="bg-dark text-light rounded p-2">...</div></div><p>以下以一個假想案例來做範例： ( 注意前兩行我們僅用到第一欄的儲存格。第二欄以後的儲存格因為未定義用途，應保持空白 )</p><div class="mb-4" style="display:grid;grid-template-columns:2em 1fr 1fr 1fr;gap:.25em"><div class="bg-light text-secondary rounded p-2 text-center">1</div><div class="bg-info text-white rounded p-2">文創產業樣貌</div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-light text-secondary rounded p-2 text-center">2</div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-light text-secondary rounded p-2 text-center">3</div><div class="bg-info text-white rounded p-2">自 104 年至 108 年，樣本 320 間公司，其中 105 年度樣本數較少，採正規化後推估。</div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-light text-secondary rounded p-2 text-center">4</div><div class="bg-secondary text-white rounded p-2">T</div><div class="bg-secondary text-white rounded p-2">C</div><div class="bg-secondary text-white rounded p-2">R</div><div class="bg-light text-secondary rounded p-2 text-center">5</div><div class="bg-secondary text-white rounded p-2">年</div><div class="bg-secondary text-white rounded p-2"> </div><div class="bg-secondary text-white rounded p-2">元新臺幣</div><div class="bg-light text-secondary rounded p-2 text-center">6</div><div class="bg-secondary text-white rounded p-2"> </div><div class="bg-secondary text-white rounded p-2"> </div><div class="bg-secondary text-white rounded p-2"> </div><div class="bg-light text-secondary rounded p-2 text-center">7</div><div class="bg-secondary text-white rounded p-2">年度</div><div class="bg-secondary text-white rounded p-2">產業別</div><div class="bg-secondary text-white rounded p-2">產值</div><div class="bg-light text-secondary rounded p-2 text-center">8</div><div class="bg-dark text-light rounded p-2">104</div><div class="bg-dark text-light rounded p-2">出版</div><div class="bg-dark text-light rounded p-2">2881</div><div class="bg-light text-secondary rounded p-2 text-center">9</div><div class="bg-dark text-light rounded p-2">104</div><div class="bg-dark text-light rounded p-2">影視</div><div class="bg-dark text-light rounded p-2">3078</div><div class="bg-light text-secondary rounded p-2 text-center">10</div><div class="bg-dark text-light rounded p-2">105</div><div class="bg-dark text-light rounded p-2">出版</div><div class="bg-dark text-light rounded p-2">2763</div><div class="bg-light text-secondary rounded p-2 text-center">10</div><div class="bg-dark text-light rounded p-2">105</div><div class="bg-dark text-light rounded p-2">影視</div><div class="bg-dark text-light rounded p-2">3159</div></div><h2>多重資料表</h2><p>如同在前文中所提到的，我們<b class="text-danger">禁止在單一檔案放多個表格</b>。每個資料檔僅能含有一個表格，再強調一次，不得將多組資料記載在同一份資料表中。下圖為一<b class="text-danger">錯誤的示範</b>，將多個表格拼貼在一個試算表中，其中包括「電影放映業」、「電影後製特效業」等兩產業，又分別將兩產業各年度之資料分不同表格記載：</p><div class="mb-4 d-flex justify-content-center"><img class="rounded border shadow-sm" src="/assets/img/spec/multi-table.png"></div><p>當多重表格混合在一起時，程式完全無法知道該如何判讀資料，也因此這樣的資料只能透過人工使用，無法輸入程式使用，這也是為什麼我們不應該這樣整理資料。</p><p>然而，分成多檔案有時會讓整理資料變得相當不容易。為方便管理, 我們可以將多個表格以 <b>不同工作簿</b> 的形式儲存在同一個試算表檔案中；只要將相關的資料放在同一個試算表中，資料整理或檔案管理都會變得相對容易。下圖展示了使用 Google Spreadsheet 做多重表格管理的範例，各個工作簿以表格標題命名，內容則依上述資料表結構編排：</p><div class="d-flex justify-content-center mb-4"><img class="rounded shadow-sm border" src="/assets/img/spec/multi-sheet.png"></div><p>由於程式使用資料時是以單一 CSV 檔為單位，而 CSV 檔並不支援工作簿的概念，我們仍需要將工作簿輸出成多個 CSV 檔，才能供給程式使用。資料表數量眾多，手工逐一輸出資料較費時，因此這時我們可以使用輔助程式如 VBA 或 Script Tool 來協助我們自動生成 CSV 檔。</p><p>輔助程式屬編輯軟體操作的範疇，並非此文件所涵蓋的範圍，但相關教學可以在網路上找到，這裡附上一個用於 Google Spreadsheet 的工具程式，可協助我們生成所有工作簿的 CSV 壓縮檔：</p><div class="rounded shadow-sm border p-4 mb-4 code bg-light text-secondary text-sm" style="height:300px;overflow-y:scroll"><div class="text-sm text-muted mb-4"><span>程式碼出處：</span><a href="https://www.drzon.net/posts/export-all-google-sheets-to-csv/">Michael DeRazon</a></div><pre><code>/*
 * script to export data in all sheets in the current spreadsheet as individual csv files
 * files will be named according to the name of the sheet
 * author: Michael Derazon
*/

function onOpen() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var csvMenuEntries = [{name: &quot;export as csv files&quot;, functionName: &quot;saveAsCSV&quot;}];
  ss.addMenu(&quot;csv&quot;, csvMenuEntries);
};

function saveAsCSV() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheets = ss.getSheets();
  // create a folder from the name of the spreadsheet
  var folder = DriveApp.createFolder(ss.getName().toLowerCase().replace(/ /g,&#39;_&#39;) + &#39;_csv_&#39; + new Date().getTime());
  for (var i = 0 ; i &lt; sheets.length ; i++) {
var sheet = sheets[i];
// append &quot;.csv&quot; extension to the sheet name
fileName = sheet.getName() + &quot;.csv&quot;;
// convert all available sheet data to csv format
var csvFile = convertRangeToCsvFile_(fileName, sheet);
// create a file in the Docs List with the given name and the csv data
folder.createFile(fileName, csvFile);
  }
  Browser.msgBox(&#39;Files are waiting in a folder named &#39; + folder.getName());
}

function convertRangeToCsvFile_(csvFileName, sheet) {
  // get available data range in the spreadsheet
  var activeRange = sheet.getDataRange();
  try {
var data = activeRange.getValues();
var csvFile = undefined;

// loop through the data in the range and build a string with the csv data
if (data.length &gt; 1) {
  var csv = &quot;&quot;;
  for (var row = 0; row &lt; data.length; row++) {
    for (var col = 0; col &lt; data[row].length; col++) {
      if (data[row][col].toString().indexOf(&quot;,&quot;) != -1) {
    data[row][col] = &quot;\&quot;&quot; + data[row][col] + &quot;\&quot;&quot;;
      }
    }

    // join each row&#39;s columns
    // add a carriage return to end of each row, except for the last one
    if (row &lt; data.length-1) {
      csv += data[row].join(&quot;,&quot;) + &quot;\r\n&quot;;
    }
    else {
      csv += data[row];
    }
  }
  csvFile = csv;
}
return csvFile;
  }
  catch(err) {
Logger.log(err);
Browser.msgBox(err);
  }
}
</code></pre>
</div><p>此程式需透過 Google Spreadsheet 的 Script Editor ( 選單 → 工具/Tool → 指令碼編輯器/Script Editor )，關於使用 Script Editor 的教學，請另參考 Google Spreadsheet 的使用文件。</p><h2>欄位規劃方針</h2><p>有時候，即便我們已經依照上述方式來整理資料，仍不免將資訊藏進欄位名稱中，減損了資料可再利用性。</p><p>比方說，下表利用多個欄位分「年度」來呈現「產值」這個數據，由於「年度」之值儲存在欄位中，並沒有對應的描述性資料 ( 年度的資料分類、單位等資訊都缺失了 )，我們在利用資訊時就變得更為侷限；此外，「產值」的概念也被混進年度之中，更難正確的解析：</p><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:.25em"><div class="cell bg-secondary">產業別</div><div class="cell bg-secondary">105年產值</div><div class="cell bg-secondary">106年產值</div><div class="cell bg-secondary">107年產值</div><div class="cell bg-dark">出版</div><div class="cell bg-dark">2517</div><div class="cell bg-dark">1923</div><div class="cell bg-dark">1498</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">3011 </div><div class="cell bg-dark">3262</div><div class="cell bg-dark">3119</div></div><p>這裡我們應考慮將欄位重新匯整成單一欄位，並將資料做對應的轉換。此動作一般稱之為「<b>反向樞紐 ( Unpivot )</b>」。</p><p>以上表為例，我們先將「年度」獨立成一欄，產業別則會因年份而需要重覆輸入，如下表左。接著，再增加一欄「產值」，將「產業別 x 年份」原本對應到的數值填回此欄，如下表右。</p><div class="row"><div class="col-md"><div class="text-sm text-muted">先將年份獨立成一欄</div><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr;gap:.25em"><div class="cell bg-secondary">產業別</div><div class="cell bg-secondary">年份</div><div class="cell bg-dark">出版</div><div class="cell bg-dark">105</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">105 </div><div class="cell bg-dark">出版</div><div class="cell bg-dark">106</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">106 </div><div class="cell bg-dark">出版</div><div class="cell bg-dark">107</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">107 </div></div></div><div class="col-md"><div class="text-sm text-muted">再依對應位置合併原本多欄的產值</div><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.25em"><div class="cell bg-secondary">產業別</div><div class="cell bg-secondary">年份</div><div class="cell bg-secondary">產值</div><div class="cell bg-dark">出版</div><div class="cell bg-dark">105</div><div class="cell bg-dark">2517</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">105 </div><div class="cell bg-dark">3011</div><div class="cell bg-dark">出版</div><div class="cell bg-dark">106</div><div class="cell bg-dark">1923</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">106 </div><div class="cell bg-dark">3262</div><div class="cell bg-dark">出版</div><div class="cell bg-dark">107</div><div class="cell bg-dark">1498</div><div class="cell bg-dark">影視</div><div class="cell bg-dark">107 </div><div class="cell bg-dark">3119</div></div></div></div><p>反向樞紐後的資料表仍能透過正向樞紐轉換變成原本的形式，卻多了額外欄位的資訊，同時程式也更容易依範圍過濾、使用額外的欄位做更多樣化的資料呈現，因此較建議在編撰資料時使用此種形式的欄位規劃。</p><h2>NOIR 資料分類法</h2><p>掌握正確良好的資料結構後，讓我們來看看資料數據本身。</p><p>數據有不同的型態，最常見的就是「文字」與「數字」的分野：</p><div class="d-flex flex-gap w-100 text-center mb-4"><div class="flex-grow-1 cell">我是文字</div><div class="flex-grow-1 cell">5447</div></div><p>數字跟文字可以做的事情不太一樣。數字可以加總、平均，文字可以排序、做分類，因此若能妥善的判斷數據的類型，我們才能正確的實現資料的視覺化。</p><p>程式基本上可以自動判斷數據的類型；然而問題是當我們有多組數據時，往往會因為一些例外狀況而使得判斷數據類型變得困難。比方說，以下兩個表格中的數字完全不應該做為數字使用，但程式很難自行判讀：</p><div class="row"><div class="col-md"><div class="d-flex flex-gap w-100 text-center mb-4 flex-column"><div class="flex-grow-1 cell bg-secondary">公司名稱</div><div class="flex-grow-1 cell">1111</div><div class="flex-grow-1 cell">104</div><div class="flex-grow-1 cell">591</div></div></div><div class="col-md"><div class="d-flex flex-gap w-100 text-center mb-4 flex-column"><div class="flex-grow-1 cell bg-secondary">公車路線</div><div class="flex-grow-1 cell">508</div><div class="flex-grow-1 cell">260</div><div class="flex-grow-1 cell">紅15</div></div></div></div><p>也因此，我們在整理資料時，最好同時將各欄資料的類型標註在表格中，這也就是我們在「試算表結構規範」一節中，表格第四行「資料類型」的用途。然而除了「文字」、「數字」外，資料還可細分成相當多不同的種類；為了避免讓資料梳理的過程變得過度複雜，我們僅依照資料視覺化的需求，使用「NOIR 資料分類法」將資料大致上分成以下幾種：</p><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr;gap:.5em"><div class="cell flex-grow-1 p-4"><div class="font-weight-bold"><b><div class="noir">N</div> Nominal / 記名式</b></div><div class="text-sm text-light">代表標示、名稱，如代號型資料，如產品編號，國家、產業別、姓名等。</div></div><div class="cell flex-grow-1 p-4"><div class="font-weight-bold"><b><div class="noir">O</div> Ordinal / 有序式</b></div><div class="text-sm text-light">可以排序的資料都可視為有序式, 但一般以直觀認定其是否有序來標註即可. 如月份, 日期, 流水號。</div></div><div class="cell flex-grow-1 p-4"><div class="font-weight-bold"><b><div class="noir">I</div> Interval / 區間式</b></div><div class="text-sm text-light">以數字為主, 若加總無意義 (如年齡相加), 或數值實為相對值 ( 如攝式溫度 ), 則視為區間式資料.</div></div><div class="cell flex-grow-1 p-4"><div class="font-weight-bold"><b><div class="noir">R</div> Ratio / 比例式</b></div><div class="text-sm text-light">非區間式的數字即為比例式。如金額、人數、面積、降雨量等等。</div></div></div><p>此外, 為更精準進行視覺化, 我們進一步將 N 與 O 類資料分為下列兩種子類：</p><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr;gap:.5em"><div class="cell flex-grow-1 p-4"><div class="font-weight-bold"><b><div class="noir">C</div> Categorical / 分類式</b></div><div class="text-sm text-light">當一組資料中此欄位中的數值僅有少數幾種數值, 可視為分類用途, 即可進一步標註為 C.</div></div><div class="cell flex-grow-1 p-4"><div class="font-weight-bold"><b><div class="noir">T</div> Temporal / 時序式</b></div><div class="text-sm text-light">時序式資料. 當有序式資料為時間的概念, 可另標註為 T</div></div></div><p>了解資料分類方式後，我們在編撰資料表時，僅需將各種資料的類型以其對應代號 ( <b class="text-danger">N O I R C T</b> ) 填入第四行之「資料類型」欄位即可。下表即為一範例，依各欄位類型填入了對應的各代碼：</p><div class="mb-4" style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr 1fr;gap:.25em"><div class="bg-info text-white rounded p-2">文創產業樣貌</div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2">&nbsp;</div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2">無註解</div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-info text-white rounded p-2"></div><div class="bg-secondary cell text-center">T</div><div class="bg-secondary cell text-center">C</div><div class="bg-secondary cell text-center">N</div><div class="bg-secondary cell text-center">O</div><div class="bg-secondary cell text-center">I</div><div class="bg-secondary cell text-center">R</div><div class="bg-secondary cell text-center">年</div><div class="bg-secondary cell text-center"> </div><div class="bg-secondary cell text-center"> </div><div class="bg-secondary cell text-center"></div><div class="bg-secondary cell text-center">%</div><div class="bg-secondary cell text-center">元新臺幣</div><div class="bg-secondary cell">&nbsp;</div><div class="bg-secondary cell"> </div><div class="bg-secondary cell"> </div><div class="bg-secondary cell"> </div><div class="bg-secondary cell"> </div><div class="bg-secondary cell"> </div><div class="bg-secondary cell text-center">年度</div><div class="bg-secondary cell text-center">產業別</div><div class="bg-secondary cell text-center">公司名</div><div class="bg-secondary cell text-center">資本額排名</div><div class="bg-secondary cell text-center">員工男女比</div><div class="bg-secondary cell text-center">產值</div><div class="cell">104</div><div class="cell">出版</div><div class="cell">雜誌A</div><div class="cell text-right">23</div><div class="cell text-right">25</div><div class="cell text-right">1237</div><div class="cell">104</div><div class="cell">出版</div><div class="cell">雜誌B</div><div class="cell text-right">15</div><div class="cell text-right">28</div><div class="cell text-right">672</div><div class="cell">104</div><div class="cell">影視</div><div class="cell">電視臺A</div><div class="cell text-right">2</div><div class="cell text-right">48</div><div class="cell text-right">7826</div><div class="cell">104</div><div class="cell">影視</div><div class="cell">電視臺B</div><div class="cell text-right">9</div><div class="cell text-right">46</div><div class="cell text-right">6271</div></div><h2>測試</h2><p>由於人工製作結構化資料難免有錯, 我們準備了一組測試用網站, 您可以將製作完成的資料檔上傳, 程式會自動分析, 提供修改建議, 並做簡單的視覺呈現, 供您做格式調整的參考。</p><p>該網站尚在準備中，敬請期待。</p><br><br><br><br><br></div></body></html>